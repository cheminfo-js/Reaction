{"version":3,"sources":["webpack:///webpack/universalModuleDefinition","webpack:///webpack/bootstrap da249e2b93d6b0d9f397","webpack:///./src/index.js","webpack:///./src/utils.js","webpack:///./node_modules/rxn-parser/src/index.js","webpack:///./src/svg-browser.js","webpack:///./node_modules/svg.js/dist/svg.js"],"names":["config","DISTANCE","SVG_OPTIONS","suppressChiralText","suppressCIPParity","suppressESR","noStereoProblem","Reaction","constructor","data","options","OCL","undefined","catPrefix","font","family","anchor","size","domElement","setOCL","fromJSON","reactionJSON","fromRXN","reactionRXN","toSVG","Error","context","draw","svg","distance","starting","reagents","products","text","selectedFont","console","log","output","group","startingGroup","drawGroup","joinBy","reagentsGroup","isVertical","add","startingBox","rbox","subFont","Object","assign","arrowBelow","i","arrow","length","currentText","Array","isArray","j","a","tspan","newLine","arrowBelowBox","move","x2","width","cy","reagentsBox","dmove","height","arrowWidth","moveCata","moveBelow","x","makeArrow","prevWidth","w","transform","scale","outputBBox","productsGroup","labels","productsBox","Math","abs","y","line","stroke","triangle","polygon","center","rotate","getGroup","g1","b","elem","svgOptions","array","currentX","currentY","currentReagent","currentSVG","String","reagentBox","dist","box","cx","getFormat","organizeData","rxnData","map","mol","Molecule","fromMolfile","ocl","getIDCodeAndCoordinates","kind","conditions","oclMap","getOCLMap","getText","current","push","fromIDCode","idCode","catalyst","find","splitShortName","getMolecularFormula","formula","solvent","replace","bestYieldStr","yield","bestYield","currentProduct","shortName","regexps","index","currentRegex","str","test","parse","rxn","TypeError","header","substr","crlf","indexOf","rxnParts","split","result","lines","numberReagents","substring","numberProducts","module","exports","default","root","factory","define","document","SVG","window","element","supported","Doc","parser","prepare","ns","xmlns","xlink","svgjs","createElementNS","createSVGRect","did","eid","name","capitalize","create","setAttribute","extend","modules","methods","key","slice","call","arguments","pop","prototype","Set","inherit","invent","initializer","construct","parent","Container","adopt","node","instance","nodeName","parentNode","SVGElement","Nested","Gradient","Element","type","namespace","defs","setData","JSON","getAttribute","body","getElementsByTagName","documentElement","nested","style","poly","polyline","path","native","addEventListener","regex","numberAndUnit","hex","rgb","reference","transforms","whitespace","isHex","isRgb","isCss","isBlank","isNumber","isPercent","isImage","delimiter","hyphen","pathLetters","isPathLetter","numbersWithDots","dots","utils","block","il","filter","radians","d","PI","degrees","r","filterSVGElements","nodes","el","defaults","attrs","fill","opacity","rx","ry","offset","Color","color","match","g","exec","parseInt","fullHex","toString","toHex","compToHex","toRgb","join","brightness","morph","destination","at","pos","isColor","fallback","valueOf","value","lastValue","lastDestination","settle","seen","string","trim","parseFloat","reverse","clone","array_clone","PointArray","toLine","x1","y1","y2","points","len","bbox","isNaN","getBBox","pathHandlers","M","c","p","p0","L","H","V","C","S","Q","T","Z","A","mlhvqtcsa","jl","toUpperCase","PathArray","arrayToString","l","equalCommands","pathArray","sourceArray","destinationArray","x0","y0","s","seg","arr","paramCnt","pathRegReplace","reduce","prev","curr","concat","Point","Number","unit","isFinite","toJSON","plus","number","minus","times","divide","to","relative","_stroke","_event","dom","attr","proportionalSize","withData","writeDataToDom","assignNewId","cloneNode","after","remove","removeElement","addTo","put","putIn","id","inside","show","hide","visible","classes","hasClass","addClass","removeClass","toggleClass","get","matches","doc","parents","selector","well","createElement","Parent","innerHTML","firstChild","childNodes","appendChild","each","fn","removeAttribute","keys","stringify","o","is","obj","easing","cos","sin","from","MorphObj","Situation","init","reversed","reversing","duration","delay","start","Date","finish","ease","loop","loops","animations","styles","once","FX","_target","situations","active","situation","paused","lastPos","absPos","_speed","animate","queue","target","timeToAbsPos","timestamp","absPosToTime","startAnimFrame","stopAnimFrame","animationFrame","requestAnimationFrame","step","bind","cancelAnimationFrame","startCurrent","initAnimations","shift","dequeue","stop","source","initialTransformation","matrixify","clearQueue","clearCurrent","jumpToEnd","atEnd","reset","temp","atStart","isAbsPos","durDivSpd","speed","pause","last","play","progress","easeIt","wrapper","e","detail","off","on","_callStart","during","eased","afterAll","duringAll","method","args","ignoreTime","absPosInt","lastLoop","max","floor","Boolean","min","fire","fx","eachAt","self","apply","Matrix","multiply","undo","extract","matrix","isEased","setTimeout","real","v","G","num","Text","plot","morphArray","leading","viewbox","ViewBox","update","Stop","Box","left","top","fullBox","merge","m","xMin","Infinity","xMax","yMin","yMax","pts","forEach","BBox","contains","topParent","Exception","Shape","clientLeft","clientTop","clientWidth","clientHeight","tbox","warn","RBox","getBoundingClientRect","addOffset","pageXOffset","pageYOffset","screenCTM","inverse","base","arrayToMatrix","abcdef","px","deltaTransformPoint","py","skewX","atan2","f","transformedX","sqrt","transformedY","skewY","scaleX","scaleY","rotation","parseMatrix","translate","around","flip","skew","tan","createSVGMatrix","ctm","getCTM","rect","getScreenCTM","point","createSVGPoint","matrixTransform","n","attributes","nodeValue","image","Image","pattern","setAttributeNS","rebuild","ensureCentre","Rotate","Scale","Skew","Translate","untransform","kv","toParent","pCtm","toDoc","Transformation","inversed","params","_undo","cssText","camelCase","children","insertBefore","has","first","deep","removeChild","clear","hasChildNodes","lastChild","_defs","ungroup","depth","Defs","flatten","view","we","he","wm","hm","reg","offsetWidth","offsetHeight","zoom","event","listeners","handlerMap","listenerId","listener","binding","ev","_svgjsListenerId","removeEventListener","Event","dispatchEvent","CustomEvent","cancelable","gbox","trans","siblings","position","next","previous","forward","backward","front","back","before","Mask","targets","unmask","mask","maskWith","masker","ClipPath","unclip","clip","clipWith","clipper","gradient","fy","Pattern","patternUnits","getElementById","version","spof","Bare","words","createTextNode","Symbol","symbol","Use","file","use","Rect","Circle","circle","Ellipse","ellipse","Line","Polyline","Polygon","_array","Path","load","url","img","_loaded","ratio","_error","src","loaded","error","_rebuild","_build","oy","nodeType","newLined","textContent","build","textPath","blankLineOffset","dy","plain","Tspan","dx","t","getComputedTextLength","TextPath","track","link","linkTo","Marker","ref","marker","sugar","prefix","extension","radius","getTotalLength","pointAt","getPointAtLength","members","elements","splice","set","remember","k","memory","forget","_memory","idFromReference","select","query","querySelectorAll","matchesSelector","msMatchesSelector","mozMatchesSelector","webkitMatchesSelector","oMatchesSelector","toLowerCase","charAt","comp","h","bubbles","createEvent","initCustomEvent","lastTime","vendors","callback","currTime","getTime","timeToCall","clearTimeout"],"mappings":"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","file":"reaction.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"reaction\"] = factory();\n\telse\n\t\troot[\"reaction\"] = factory();\n})(this, function() {\nreturn \n\n\n// WEBPACK FOOTER //\n// webpack/universalModuleDefinition"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 0);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap da249e2b93d6b0d9f397","import {\n    getFormat,\n    organizeData\n} from './utils';\nimport SVG from './svg';\n\nconst config = {\n    DISTANCE: 10, // separation distance between elements of the svg\n    SVG_OPTIONS: { // configuration for the svg retrieved from OCL\n        suppressChiralText: true,\n        suppressCIPParity: true,\n        suppressESR: true,\n        noStereoProblem: true\n    }\n};\n\nexport default class Reaction {\n    constructor(data, options) {\n        this.data = data;\n        this.OCL = undefined;\n\n        var {\n            catPrefix = false,\n            font = {\n                family: 'Helvetica',\n                anchor: 'middle',\n                size: 15\n            },\n            domElement\n        } = options;\n\n        this.catPrefix = catPrefix;\n        this.font = font;\n        this.domElement = domElement;\n    }\n\n    setOCL(OCL) {\n        this.OCL = OCL;\n    }\n\n    static fromJSON(reactionJSON, options) {\n        return new Reaction(reactionJSON, options);\n    }\n\n    static fromRXN(reactionRXN, options) {\n        return Reaction.fromJSON(getFormat(reactionRXN), options);\n    }\n\n    toSVG() {\n        if (this.OCL === undefined) {\n            throw new Error('OCL is not defined on this instance of reaction');\n        }\n\n        var data = organizeData(this.data, this.catPrefix, this.OCL);\n        var context = SVG(this.domElement);\n        draw(context, data, this.font);\n\n        return context.svg();\n    }\n}\n\nconst distance = 10;\n\nfunction draw(context, data, font) {\n    var {\n        starting,\n        reagents,\n        products,\n        text\n    } = data;\n\n    var selectedFont = font;\n\n    console.log(context);\n    var output = context.group();\n    var startingGroup = drawGroup(context, starting, {\n        joinBy: '+',\n        font: selectedFont\n    });\n\n    var reagentsGroup = drawGroup(context, reagents, {\n        joinBy: '',\n        isVertical: true\n    });\n    output.add(startingGroup);\n    output.add(reagentsGroup);\n\n    var startingBox = startingGroup.rbox(context);\n    // var reagentBox = reagentsGroup.rbox(context);\n\n    // put catalyst over the arrow\n    var subFont = Object.assign({}, selectedFont, {\n        'baseline-shift': 'sub',\n        'font-size': 'small'\n    });\n    var arrowBelow = context.text(function (add) {\n        for (var i = 0; i < text.arrow.length; ++i) {\n            var currentText = text.arrow[i];\n            if (Array.isArray(currentText)) {\n                // process MF\n                for (var j = 0; j < currentText.length; ++j) {\n                    var a = add.tspan(currentText[j]);\n                    if (j % 2 === 1) {\n                        a.font(subFont);\n                    } else {\n                        a.font(selectedFont);\n                    }\n                }\n            } else if (currentText !== '') {\n                add.tspan(currentText).font(selectedFont);\n                if (currentText === 'Cat. ') {\n                    continue;\n                }\n            }\n            add.tspan(' ').font(selectedFont).newLine();\n        }\n    });\n\n    //arrowBelow.font(selectedFont);\n    var arrowBelowBox = arrowBelow.rbox(context);\n    arrowBelow.move(startingBox.x2 + arrowBelowBox.width / 2.0 + config.DISTANCE, startingBox.cy + config.DISTANCE);\n\n    var reagentsBox = reagentsGroup.rbox(context);\n    reagentsGroup.dmove(startingBox.width / 2.0 + reagentsBox.width / 2.0 + config.DISTANCE,\n        startingBox.cy - reagentsBox.cy - (reagentsBox.height / 2.0) - config.DISTANCE);\n\n    var arrowWidth = distance;\n    reagentsBox = reagentsGroup.rbox(context);\n    arrowBelowBox = arrowBelow.rbox(context);\n\n    if (arrowBelowBox.width > reagentsBox.width) {\n        arrowWidth += arrowBelowBox.width;\n        var moveCata = arrowWidth / 2.0 - reagentsBox.width / 2.0;\n        var moveBelow = config.DISTANCE / 2.0;\n    } else {\n        arrowWidth += reagentsBox.width;\n        moveCata = config.DISTANCE / 2.0;\n        moveBelow = arrowWidth / 2.0 - arrowBelowBox.width / 2.0;\n    }\n    reagentsGroup.x(reagentsGroup.x() + moveCata);\n\n    arrowBelow.x(arrowBelow.x() + moveBelow);\n    var arrow = makeArrow(context, startingBox.x2 + config.DISTANCE, startingBox.cy, arrowWidth);\n\n    // once we have it on the right position we can shrink it\n    var prevWidth = reagentsGroup.rbox(context).w;\n    reagentsGroup.transform({\n        scale: 0.8\n    });\n    var width = reagentsGroup.rbox(context).w;\n    reagentsGroup.dmove(0, prevWidth - width - config.DISTANCE);\n\n\n    output.add(arrow);\n    output.add(arrowBelow);\n\n    var outputBBox = output.rbox(context);\n    var productsGroup = drawGroup(context, products, {\n        labels: text.products,\n        isVertical: false,\n        joinBy: '+',\n        font: selectedFont\n    });\n    var productsBox = productsGroup.rbox(context);\n    productsGroup.dmove(Math.abs(outputBBox.x2 - productsBox.x) + config.DISTANCE, 0);\n\n    output.add(productsGroup);\n\n    outputBBox = output.rbox(context);\n    context.size(outputBBox.x + outputBBox.width, outputBBox.y + outputBBox.height);\n}\n\nfunction makeArrow(context, x, y, width) {\n    var arrow = context.group();\n    arrow.line(x, y, x + width, y).stroke({\n        width: 1\n    });\n    var triangle = arrow.polygon([0, 0, 7, 7, 0, 7]);\n    triangle.center(x + width, y).rotate(-135);\n    return arrow;\n}\n\nfunction getGroup(context, svg) {\n    var g1 = context.group();\n    g1.svg(svg);\n    var b = g1.rbox(context);\n    g1.move(-b.x, -b.y);\n\n    return g1;\n}\n\nfunction move(elem, x, y) {\n    elem.center(elem.x() + x, elem.y() + y);\n}\n\nconst svgOptions = {\n    suppressChiralText: true,\n    suppressCIPParity: true,\n    suppressESR: true,\n    noStereoProblem: true\n};\n\nfunction drawGroup(context, array, options) {\n    var {\n        joinBy,\n        isVertical,\n        labels,\n        font\n    } = options;\n\n    var group = context.group();\n    var currentX = 100;\n    var currentY = 100;\n    for (var i = 0; i < array.length; ++i) {\n        var currentReagent = array[i];\n        var currentSVG = currentReagent.toSVG(200, 200, String(i), svgOptions);\n        var elem = getGroup(context, currentSVG);\n\n        if (joinBy && i > 0) {\n            var text = group.text(joinBy);\n            text.center(currentX, currentY);\n            var reagentBox = elem.rbox(context);\n            var dist = config.DISTANCE + reagentBox.width / 2.0;\n            if (isVertical) {\n                currentY += dist;\n            } else {\n                currentX += dist;\n            }\n        }\n\n        move(elem, currentX, currentY);\n        var box = elem.rbox(context);\n        if (labels && labels[i]) {\n            text = group.text(labels[i]);\n            text.font(font);\n            text.move(box.cx, box.cy + 20);\n        }\n\n        dist = config.DISTANCE + box.width / 2.0;\n        if (isVertical) {\n            currentY += dist;\n        } else {\n            currentX += dist;\n        }\n        group.add(elem);\n    }\n    group.move(100, 100);\n\n    return group;\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/index.js","import parse from 'rxn-parser';\n\nexport function getFormat(rxnData, OCL) {\n    var {\n        reagents,\n        products\n    } = parse(rxnData);\n\n    reagents = reagents.map(elem => {\n        var output = {};\n        var mol = OCL.Molecule.fromMolfile(elem);\n        output.ocl = mol.getIDCodeAndCoordinates();\n        output.kind = 'starting material';\n\n        return output;\n    });\n\n    products = products.map(elem => {\n        var output = {};\n        var mol = OCL.Molecule.fromMolfile(elem);\n        output.ocl = mol.getIDCodeAndCoordinates();\n\n        return output;\n    });\n\n\n    return {\n        reagents: reagents,\n        products: products,\n        conditions: ''\n    };\n}\n\nexport function organizeData(data, catPrefix, OCL) {\n    var oclMap = getOCLMap(OCL);\n    var output = {\n        products: data.products.map(oclMap),\n        text: getText(data, catPrefix, oclMap)\n    };\n\n    var starting = [];\n    var reagents = [];\n\n\n    for (var i = 0; i < data.reagents.length; ++i) {\n        var current = data.reagents[i];\n        switch (current.kind) {\n            case 'reagent':\n                reagents.push(oclMap(current));\n                break;\n            case 'starting material':\n                starting.push(oclMap(current));\n                break;\n            default:\n        }\n    }\n\n    output.starting = starting;\n    output.reagents = reagents;\n\n    return output;\n}\n\nfunction getOCLMap(OCL) {\n    return (elem) => OCL.Molecule.fromIDCode(elem.ocl.idCode);\n}\n\nfunction getText(data, catPrefix, oclMap) {\n    var output = {\n        products: []\n    };\n\n    var arrow = [];\n\n    // add catalyst\n    var catalyst = data.reagents.find(elem => elem.kind === 'catalyst');\n    if (catalyst) {\n        if (catPrefix) {\n            arrow.push('Cat. ');\n        }\n        arrow.push(splitShortName(oclMap(catalyst).getMolecularFormula().formula));\n    }\n\n    // add solvent\n    var solvent = data.reagents.find(elem => elem.kind === 'solvent');\n    if (solvent) {\n        arrow.push(splitShortName(oclMap(solvent).getMolecularFormula().formula));\n    }\n\n    arrow.push(data.conditions.replace(/(<([^>]+)>)|\\n/ig, ''));\n    var products = data.products;\n    var bestYieldStr = '';\n    if (products.length === 1) {\n        bestYieldStr = `Best yield: ${String(products[0].yield)} %`;\n    } else if (products.length > 1) {\n        var bestYield = -1;\n        for (var i = 0; i < products.length; ++i) {\n            var currentProduct = products[i];\n            output.products.push(`${String(currentProduct.yield)} %`);\n            if (currentProduct.yield > bestYield) {\n                bestYield = currentProduct.yield;\n            }\n        }\n        bestYieldStr = `Best yield: ${String(bestYield)} %`;\n    }\n\n    arrow.push(bestYieldStr);\n    output.arrow = arrow;\n\n    return output;\n}\n\nfunction splitShortName(shortName) {\n    var regexps = [/[A-Za-z]/, /\\d/];\n    var index = 0;\n    var currentRegex = regexps[index];\n    var output = [];\n    var str = '';\n    for (var i = 0; i < shortName.length; ++i) {\n        if (currentRegex.test(shortName[i])) {\n            str += shortName[i];\n        } else {\n            output.push(str);\n            str = shortName[i];\n            index = (index + 1) % 2;\n            currentRegex = regexps[index];\n        }\n    }\n    output.push(str);\n    return output;\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/utils.js","'use strict';\n\nfunction parse(rxn) {\n    if (typeof rxn !== 'string') {\n        throw new TypeError('Parameter \"rxn\" must be a string');\n    }\n    // we will find the delimiter in order to be much faster and not use regular expression\n    var header = rxn.substr(0, 1000);\n    var crlf = '\\n';\n    if (header.indexOf('\\r\\n') > -1) {\n        crlf = '\\r\\n';\n    } else if (header.indexOf('\\r') > -1) {\n        crlf = '\\r';\n    }\n\n    var rxnParts = rxn.split(crlf + '$MOL' + crlf);\n\n    var reagents=[];\n    var products=[];\n\n    var result={};\n    result.reagents=reagents;\n    result.products=products;\n\n\n    // the first part is expected to contain the number of reagents and products\n\n    // First part should start with $RXN\n    // and the fifth line should contain the number of reagents and products\n    if (rxnParts.length===0) throw new Error('file looks empty');\n\n    var header=rxnParts[0];\n    if (header.indexOf(\"$RXN\")!=0) throw new Error('file does not start with $RXN');\n\n    var lines=header.split(crlf);\n    if (lines.length<5) throw new Error('incorrect number of lines in header');\n\n    var numberReagents=lines[4].substring(0,3) >> 0;\n    var numberProducts=lines[4].substring(3,6) >> 0;\n\n    if (numberReagents+numberProducts!=rxnParts.length-1) throw new Error('not the correct number of molecules');\n\n    for (var i=1; i<rxnParts.length; i++) {\n        if (i<=numberReagents) {\n            reagents.push(rxnParts[i]);\n        } else {\n            products.push(rxnParts[i]);\n        }\n    }\n    return result;\n\n}\n\nmodule.exports = parse;\n\n\n\n// WEBPACK FOOTER //\n// ./node_modules/rxn-parser/src/index.js","export {default as default} from 'svg.js';\nconsole.log(\"im in a browser!\")\n\n\n// WEBPACK FOOTER //\n// ./src/svg-browser.js","/*!\n* svg.js - A lightweight library for manipulating and animating SVG.\n* @version 2.6.3\n* https://svgdotjs.github.io/\n*\n* @copyright Wout Fierens <wout@mick-wout.com>\n* @license MIT\n*\n* BUILT: Fri Jul 21 2017 14:50:37 GMT+0200 (Mitteleuropische Sommerzeit)\n*/;\n(function(root, factory) {\r\n  /* istanbul ignore next */\r\n  if (typeof define === 'function' && define.amd) {\r\n    define(function(){\r\n      return factory(root, root.document)\r\n    })\r\n  } else if (typeof exports === 'object') {\r\n    module.exports = root.document ? factory(root, root.document) : function(w){ return factory(w, w.document) }\r\n  } else {\r\n    root.SVG = factory(root, root.document)\r\n  }\r\n}(typeof window !== \"undefined\" ? window : this, function(window, document) {\r\n\r\n// The main wrapping element\r\nvar SVG = this.SVG = function(element) {\r\n  if (SVG.supported) {\r\n    element = new SVG.Doc(element)\r\n\r\n    if(!SVG.parser.draw)\r\n      SVG.prepare()\r\n\r\n    return element\r\n  }\r\n}\r\n\r\n// Default namespaces\r\nSVG.ns    = 'http://www.w3.org/2000/svg'\r\nSVG.xmlns = 'http://www.w3.org/2000/xmlns/'\r\nSVG.xlink = 'http://www.w3.org/1999/xlink'\r\nSVG.svgjs = 'http://svgjs.com/svgjs'\r\n\r\n// Svg support test\r\nSVG.supported = (function() {\r\n  return !! document.createElementNS &&\r\n         !! document.createElementNS(SVG.ns,'svg').createSVGRect\r\n})()\r\n\r\n// Don't bother to continue if SVG is not supported\r\nif (!SVG.supported) return false\r\n\r\n// Element id sequence\r\nSVG.did  = 1000\r\n\r\n// Get next named element id\r\nSVG.eid = function(name) {\r\n  return 'Svgjs' + capitalize(name) + (SVG.did++)\r\n}\r\n\r\n// Method for element creation\r\nSVG.create = function(name) {\r\n  // create element\r\n  var element = document.createElementNS(this.ns, name)\r\n\r\n  // apply unique id\r\n  element.setAttribute('id', this.eid(name))\r\n\r\n  return element\r\n}\r\n\r\n// Method for extending objects\r\nSVG.extend = function() {\r\n  var modules, methods, key, i\r\n\r\n  // Get list of modules\r\n  modules = [].slice.call(arguments)\r\n\r\n  // Get object with extensions\r\n  methods = modules.pop()\r\n\r\n  for (i = modules.length - 1; i >= 0; i--)\r\n    if (modules[i])\r\n      for (key in methods)\r\n        modules[i].prototype[key] = methods[key]\r\n\r\n  // Make sure SVG.Set inherits any newly added methods\r\n  if (SVG.Set && SVG.Set.inherit)\r\n    SVG.Set.inherit()\r\n}\r\n\r\n// Invent new element\r\nSVG.invent = function(config) {\r\n  // Create element initializer\r\n  var initializer = typeof config.create == 'function' ?\r\n    config.create :\r\n    function() {\r\n      this.constructor.call(this, SVG.create(config.create))\r\n    }\r\n\r\n  // Inherit prototype\r\n  if (config.inherit)\r\n    initializer.prototype = new config.inherit\r\n\r\n  // Extend with methods\r\n  if (config.extend)\r\n    SVG.extend(initializer, config.extend)\r\n\r\n  // Attach construct method to parent\r\n  if (config.construct)\r\n    SVG.extend(config.parent || SVG.Container, config.construct)\r\n\r\n  return initializer\r\n}\r\n\r\n// Adopt existing svg elements\r\nSVG.adopt = function(node) {\r\n  // check for presence of node\r\n  if (!node) return null\r\n\r\n  // make sure a node isn't already adopted\r\n  if (node.instance) return node.instance\r\n\r\n  // initialize variables\r\n  var element\r\n\r\n  // adopt with element-specific settings\r\n  if (node.nodeName == 'svg')\r\n    element = node.parentNode instanceof window.SVGElement ? new SVG.Nested : new SVG.Doc\r\n  else if (node.nodeName == 'linearGradient')\r\n    element = new SVG.Gradient('linear')\r\n  else if (node.nodeName == 'radialGradient')\r\n    element = new SVG.Gradient('radial')\r\n  else if (SVG[capitalize(node.nodeName)])\r\n    element = new SVG[capitalize(node.nodeName)]\r\n  else\r\n    element = new SVG.Element(node)\r\n\r\n  // ensure references\r\n  element.type  = node.nodeName\r\n  element.node  = node\r\n  node.instance = element\r\n\r\n  // SVG.Class specific preparations\r\n  if (element instanceof SVG.Doc)\r\n    element.namespace().defs()\r\n\r\n  // pull svgjs data from the dom (getAttributeNS doesn't work in html5)\r\n  element.setData(JSON.parse(node.getAttribute('svgjs:data')) || {})\r\n\r\n  return element\r\n}\r\n\r\n// Initialize parsing element\r\nSVG.prepare = function() {\r\n  // Select document body and create invisible svg element\r\n  var body = document.getElementsByTagName('body')[0]\r\n    , draw = (body ? new SVG.Doc(body) : SVG.adopt(document.documentElement).nested()).size(2, 0)\r\n\r\n  // Create parser object\r\n  SVG.parser = {\r\n    body: body || document.documentElement\r\n  , draw: draw.style('opacity:0;position:absolute;left:-100%;top:-100%;overflow:hidden').node\r\n  , poly: draw.polyline().node\r\n  , path: draw.path().node\r\n  , native: SVG.create('svg')\r\n  }\r\n}\r\n\r\nSVG.parser = {\r\n  native: SVG.create('svg')\r\n}\r\n\r\ndocument.addEventListener('DOMContentLoaded', function() {\r\n  if(!SVG.parser.draw)\r\n    SVG.prepare()\r\n}, false)\r\n\n// Storage for regular expressions\r\nSVG.regex = {\r\n  // Parse unit value\r\n  numberAndUnit:    /^([+-]?(\\d+(\\.\\d*)?|\\.\\d+)(e[+-]?\\d+)?)([a-z%]*)$/i\r\n\r\n  // Parse hex value\r\n, hex:              /^#?([a-f\\d]{2})([a-f\\d]{2})([a-f\\d]{2})$/i\r\n\r\n  // Parse rgb value\r\n, rgb:              /rgb\\((\\d+),(\\d+),(\\d+)\\)/\r\n\r\n  // Parse reference id\r\n, reference:        /#([a-z0-9\\-_]+)/i\r\n\r\n  // splits a transformation chain\r\n, transforms:       /\\)\\s*,?\\s*/\r\n\r\n  // Whitespace\r\n, whitespace:       /\\s/g\r\n\r\n  // Test hex value\r\n, isHex:            /^#[a-f0-9]{3,6}$/i\r\n\r\n  // Test rgb value\r\n, isRgb:            /^rgb\\(/\r\n\r\n  // Test css declaration\r\n, isCss:            /[^:]+:[^;]+;?/\r\n\r\n  // Test for blank string\r\n, isBlank:          /^(\\s+)?$/\r\n\r\n  // Test for numeric string\r\n, isNumber:         /^[+-]?(\\d+(\\.\\d*)?|\\.\\d+)(e[+-]?\\d+)?$/i\r\n\r\n  // Test for percent value\r\n, isPercent:        /^-?[\\d\\.]+%$/\r\n\r\n  // Test for image url\r\n, isImage:          /\\.(jpg|jpeg|png|gif|svg)(\\?[^=]+.*)?/i\r\n\r\n  // split at whitespace and comma\r\n, delimiter:        /[\\s,]+/\r\n\r\n  // The following regex are used to parse the d attribute of a path\r\n\r\n  // Matches all hyphens which are not after an exponent\r\n, hyphen:           /([^e])\\-/gi\r\n\r\n  // Replaces and tests for all path letters\r\n, pathLetters:      /[MLHVCSQTAZ]/gi\r\n\r\n  // yes we need this one, too\r\n, isPathLetter:     /[MLHVCSQTAZ]/i\r\n\r\n  // matches 0.154.23.45\r\n, numbersWithDots:  /((\\d?\\.\\d+(?:e[+-]?\\d+)?)((?:\\.\\d+(?:e[+-]?\\d+)?)+))+/gi\r\n\r\n  // matches .\r\n, dots:             /\\./g\r\n}\r\n\nSVG.utils = {\r\n  // Map function\r\n  map: function(array, block) {\r\n    var i\r\n      , il = array.length\r\n      , result = []\r\n\r\n    for (i = 0; i < il; i++)\r\n      result.push(block(array[i]))\r\n\r\n    return result\r\n  }\r\n\r\n  // Filter function\r\n, filter: function(array, block) {\r\n    var i\r\n      , il = array.length\r\n      , result = []\r\n\r\n    for (i = 0; i < il; i++)\r\n      if (block(array[i]))\r\n        result.push(array[i])\r\n\r\n    return result\r\n  }\r\n\r\n  // Degrees to radians\r\n, radians: function(d) {\r\n    return d % 360 * Math.PI / 180\r\n  }\r\n\r\n  // Radians to degrees\r\n, degrees: function(r) {\r\n    return r * 180 / Math.PI % 360\r\n  }\r\n\r\n, filterSVGElements: function(nodes) {\r\n    return this.filter( nodes, function(el) { return el instanceof window.SVGElement })\r\n  }\r\n\r\n}\n\r\nSVG.defaults = {\r\n  // Default attribute values\r\n  attrs: {\r\n    // fill and stroke\r\n    'fill-opacity':     1\r\n  , 'stroke-opacity':   1\r\n  , 'stroke-width':     0\r\n  , 'stroke-linejoin':  'miter'\r\n  , 'stroke-linecap':   'butt'\r\n  , fill:               '#000000'\r\n  , stroke:             '#000000'\r\n  , opacity:            1\r\n    // position\r\n  , x:                  0\r\n  , y:                  0\r\n  , cx:                 0\r\n  , cy:                 0\r\n    // size\r\n  , width:              0\r\n  , height:             0\r\n    // radius\r\n  , r:                  0\r\n  , rx:                 0\r\n  , ry:                 0\r\n    // gradient\r\n  , offset:             0\r\n  , 'stop-opacity':     1\r\n  , 'stop-color':       '#000000'\r\n    // text\r\n  , 'font-size':        16\r\n  , 'font-family':      'Helvetica, Arial, sans-serif'\r\n  , 'text-anchor':      'start'\r\n  }\r\n\r\n}\n// Module for color convertions\r\nSVG.Color = function(color) {\r\n  var match\r\n\r\n  // initialize defaults\r\n  this.r = 0\r\n  this.g = 0\r\n  this.b = 0\r\n\r\n  if(!color) return\r\n\r\n  // parse color\r\n  if (typeof color === 'string') {\r\n    if (SVG.regex.isRgb.test(color)) {\r\n      // get rgb values\r\n      match = SVG.regex.rgb.exec(color.replace(SVG.regex.whitespace,''))\r\n\r\n      // parse numeric values\r\n      this.r = parseInt(match[1])\r\n      this.g = parseInt(match[2])\r\n      this.b = parseInt(match[3])\r\n\r\n    } else if (SVG.regex.isHex.test(color)) {\r\n      // get hex values\r\n      match = SVG.regex.hex.exec(fullHex(color))\r\n\r\n      // parse numeric values\r\n      this.r = parseInt(match[1], 16)\r\n      this.g = parseInt(match[2], 16)\r\n      this.b = parseInt(match[3], 16)\r\n\r\n    }\r\n\r\n  } else if (typeof color === 'object') {\r\n    this.r = color.r\r\n    this.g = color.g\r\n    this.b = color.b\r\n\r\n  }\r\n\r\n}\r\n\r\nSVG.extend(SVG.Color, {\r\n  // Default to hex conversion\r\n  toString: function() {\r\n    return this.toHex()\r\n  }\r\n  // Build hex value\r\n, toHex: function() {\r\n    return '#'\r\n      + compToHex(this.r)\r\n      + compToHex(this.g)\r\n      + compToHex(this.b)\r\n  }\r\n  // Build rgb value\r\n, toRgb: function() {\r\n    return 'rgb(' + [this.r, this.g, this.b].join() + ')'\r\n  }\r\n  // Calculate true brightness\r\n, brightness: function() {\r\n    return (this.r / 255 * 0.30)\r\n         + (this.g / 255 * 0.59)\r\n         + (this.b / 255 * 0.11)\r\n  }\r\n  // Make color morphable\r\n, morph: function(color) {\r\n    this.destination = new SVG.Color(color)\r\n\r\n    return this\r\n  }\r\n  // Get morphed color at given position\r\n, at: function(pos) {\r\n    // make sure a destination is defined\r\n    if (!this.destination) return this\r\n\r\n    // normalise pos\r\n    pos = pos < 0 ? 0 : pos > 1 ? 1 : pos\r\n\r\n    // generate morphed color\r\n    return new SVG.Color({\r\n      r: ~~(this.r + (this.destination.r - this.r) * pos)\r\n    , g: ~~(this.g + (this.destination.g - this.g) * pos)\r\n    , b: ~~(this.b + (this.destination.b - this.b) * pos)\r\n    })\r\n  }\r\n\r\n})\r\n\r\n// Testers\r\n\r\n// Test if given value is a color string\r\nSVG.Color.test = function(color) {\r\n  color += ''\r\n  return SVG.regex.isHex.test(color)\r\n      || SVG.regex.isRgb.test(color)\r\n}\r\n\r\n// Test if given value is a rgb object\r\nSVG.Color.isRgb = function(color) {\r\n  return color && typeof color.r == 'number'\r\n               && typeof color.g == 'number'\r\n               && typeof color.b == 'number'\r\n}\r\n\r\n// Test if given value is a color\r\nSVG.Color.isColor = function(color) {\r\n  return SVG.Color.isRgb(color) || SVG.Color.test(color)\r\n}\n// Module for array conversion\r\nSVG.Array = function(array, fallback) {\r\n  array = (array || []).valueOf()\r\n\r\n  // if array is empty and fallback is provided, use fallback\r\n  if (array.length == 0 && fallback)\r\n    array = fallback.valueOf()\r\n\r\n  // parse array\r\n  this.value = this.parse(array)\r\n}\r\n\r\nSVG.extend(SVG.Array, {\r\n  // Make array morphable\r\n  morph: function(array) {\r\n    this.destination = this.parse(array)\r\n\r\n    // normalize length of arrays\r\n    if (this.value.length != this.destination.length) {\r\n      var lastValue       = this.value[this.value.length - 1]\r\n        , lastDestination = this.destination[this.destination.length - 1]\r\n\r\n      while(this.value.length > this.destination.length)\r\n        this.destination.push(lastDestination)\r\n      while(this.value.length < this.destination.length)\r\n        this.value.push(lastValue)\r\n    }\r\n\r\n    return this\r\n  }\r\n  // Clean up any duplicate points\r\n, settle: function() {\r\n    // find all unique values\r\n    for (var i = 0, il = this.value.length, seen = []; i < il; i++)\r\n      if (seen.indexOf(this.value[i]) == -1)\r\n        seen.push(this.value[i])\r\n\r\n    // set new value\r\n    return this.value = seen\r\n  }\r\n  // Get morphed array at given position\r\n, at: function(pos) {\r\n    // make sure a destination is defined\r\n    if (!this.destination) return this\r\n\r\n    // generate morphed array\r\n    for (var i = 0, il = this.value.length, array = []; i < il; i++)\r\n      array.push(this.value[i] + (this.destination[i] - this.value[i]) * pos)\r\n\r\n    return new SVG.Array(array)\r\n  }\r\n  // Convert array to string\r\n, toString: function() {\r\n    return this.value.join(' ')\r\n  }\r\n  // Real value\r\n, valueOf: function() {\r\n    return this.value\r\n  }\r\n  // Parse whitespace separated string\r\n, parse: function(array) {\r\n    array = array.valueOf()\r\n\r\n    // if already is an array, no need to parse it\r\n    if (Array.isArray(array)) return array\r\n\r\n    return this.split(array)\r\n  }\r\n  // Strip unnecessary whitespace\r\n, split: function(string) {\r\n    return string.trim().split(SVG.regex.delimiter).map(parseFloat)\r\n  }\r\n  // Reverse array\r\n, reverse: function() {\r\n    this.value.reverse()\r\n\r\n    return this\r\n  }\r\n, clone: function() {\r\n    var clone = new this.constructor()\r\n    clone.value = array_clone(this.value)\r\n    return clone\r\n  }\r\n})\n// Poly points array\r\nSVG.PointArray = function(array, fallback) {\r\n  SVG.Array.call(this, array, fallback || [[0,0]])\r\n}\r\n\r\n// Inherit from SVG.Array\r\nSVG.PointArray.prototype = new SVG.Array\r\nSVG.PointArray.prototype.constructor = SVG.PointArray\r\n\r\nSVG.extend(SVG.PointArray, {\r\n  // Convert array to string\r\n  toString: function() {\r\n    // convert to a poly point string\r\n    for (var i = 0, il = this.value.length, array = []; i < il; i++)\r\n      array.push(this.value[i].join(','))\r\n\r\n    return array.join(' ')\r\n  }\r\n  // Convert array to line object\r\n, toLine: function() {\r\n    return {\r\n      x1: this.value[0][0]\r\n    , y1: this.value[0][1]\r\n    , x2: this.value[1][0]\r\n    , y2: this.value[1][1]\r\n    }\r\n  }\r\n  // Get morphed array at given position\r\n, at: function(pos) {\r\n    // make sure a destination is defined\r\n    if (!this.destination) return this\r\n\r\n    // generate morphed point string\r\n    for (var i = 0, il = this.value.length, array = []; i < il; i++)\r\n      array.push([\r\n        this.value[i][0] + (this.destination[i][0] - this.value[i][0]) * pos\r\n      , this.value[i][1] + (this.destination[i][1] - this.value[i][1]) * pos\r\n      ])\r\n\r\n    return new SVG.PointArray(array)\r\n  }\r\n  // Parse point string and flat array\r\n, parse: function(array) {\r\n    var points = []\r\n\r\n    array = array.valueOf()\r\n\r\n    // if it is an array\r\n    if (Array.isArray(array)) {\r\n      // and it is not flat, there is no need to parse it\r\n      if(Array.isArray(array[0])) {\r\n        return array\r\n      }\r\n    } else { // Else, it is considered as a string\r\n      // parse points\r\n      array = array.trim().split(SVG.regex.delimiter).map(parseFloat)\r\n    }\r\n\r\n    // validate points - https://svgwg.org/svg2-draft/shapes.html#DataTypePoints\r\n    // Odd number of coordinates is an error. In such cases, drop the last odd coordinate.\r\n    if (array.length % 2 !== 0) array.pop()\r\n\r\n    // wrap points in two-tuples and parse points as floats\r\n    for(var i = 0, len = array.length; i < len; i = i + 2)\r\n      points.push([ array[i], array[i+1] ])\r\n\r\n    return points\r\n  }\r\n  // Move point string\r\n, move: function(x, y) {\r\n    var box = this.bbox()\r\n\r\n    // get relative offset\r\n    x -= box.x\r\n    y -= box.y\r\n\r\n    // move every point\r\n    if (!isNaN(x) && !isNaN(y))\r\n      for (var i = this.value.length - 1; i >= 0; i--)\r\n        this.value[i] = [this.value[i][0] + x, this.value[i][1] + y]\r\n\r\n    return this\r\n  }\r\n  // Resize poly string\r\n, size: function(width, height) {\r\n    var i, box = this.bbox()\r\n\r\n    // recalculate position of all points according to new size\r\n    for (i = this.value.length - 1; i >= 0; i--) {\r\n      if(box.width) this.value[i][0] = ((this.value[i][0] - box.x) * width)  / box.width  + box.x\r\n      if(box.height) this.value[i][1] = ((this.value[i][1] - box.y) * height) / box.height + box.y\r\n    }\r\n\r\n    return this\r\n  }\r\n  // Get bounding box of points\r\n, bbox: function() {\r\n    SVG.parser.poly.setAttribute('points', this.toString())\r\n\r\n    return SVG.parser.poly.getBBox()\r\n  }\r\n})\r\n\nvar pathHandlers = {\r\n  M: function(c, p, p0) {\r\n    p.x = p0.x = c[0]\r\n    p.y = p0.y = c[1]\r\n\r\n    return ['M', p.x, p.y]\r\n  },\r\n  L: function(c, p) {\r\n    p.x = c[0]\r\n    p.y = c[1]\r\n    return ['L', c[0], c[1]]\r\n  },\r\n  H: function(c, p) {\r\n    p.x = c[0]\r\n    return ['H', c[0]]\r\n  },\r\n  V: function(c, p) {\r\n    p.y = c[0]\r\n    return ['V', c[0]]\r\n  },\r\n  C: function(c, p) {\r\n    p.x = c[4]\r\n    p.y = c[5]\r\n    return ['C', c[0], c[1], c[2], c[3], c[4], c[5]]\r\n  },\r\n  S: function(c, p) {\r\n    p.x = c[2]\r\n    p.y = c[3]\r\n    return ['S', c[0], c[1], c[2], c[3]]\r\n  },\r\n  Q: function(c, p) {\r\n    p.x = c[2]\r\n    p.y = c[3]\r\n    return ['Q', c[0], c[1], c[2], c[3]]\r\n  },\r\n  T: function(c, p) {\r\n    p.x = c[0]\r\n    p.y = c[1]\r\n    return ['T', c[0], c[1]]\r\n  },\r\n  Z: function(c, p, p0) {\r\n    p.x = p0.x\r\n    p.y = p0.y\r\n    return ['Z']\r\n  },\r\n  A: function(c, p) {\r\n    p.x = c[5]\r\n    p.y = c[6]\r\n    return ['A', c[0], c[1], c[2], c[3], c[4], c[5], c[6]]\r\n  }\r\n}\r\n\r\nvar mlhvqtcsa = 'mlhvqtcsaz'.split('')\r\n\r\nfor(var i = 0, il = mlhvqtcsa.length; i < il; ++i){\r\n  pathHandlers[mlhvqtcsa[i]] = (function(i){\r\n    return function(c, p, p0) {\r\n      if(i == 'H') c[0] = c[0] + p.x\r\n      else if(i == 'V') c[0] = c[0] + p.y\r\n      else if(i == 'A'){\r\n        c[5] = c[5] + p.x,\r\n        c[6] = c[6] + p.y\r\n      }\r\n      else\r\n        for(var j = 0, jl = c.length; j < jl; ++j) {\r\n          c[j] = c[j] + (j%2 ? p.y : p.x)\r\n        }\r\n\r\n      return pathHandlers[i](c, p, p0)\r\n    }\r\n  })(mlhvqtcsa[i].toUpperCase())\r\n}\r\n\r\n// Path points array\r\nSVG.PathArray = function(array, fallback) {\r\n  SVG.Array.call(this, array, fallback || [['M', 0, 0]])\r\n}\r\n\r\n// Inherit from SVG.Array\r\nSVG.PathArray.prototype = new SVG.Array\r\nSVG.PathArray.prototype.constructor = SVG.PathArray\r\n\r\nSVG.extend(SVG.PathArray, {\r\n  // Convert array to string\r\n  toString: function() {\r\n    return arrayToString(this.value)\r\n  }\r\n  // Move path string\r\n, move: function(x, y) {\r\n    // get bounding box of current situation\r\n    var box = this.bbox()\r\n\r\n    // get relative offset\r\n    x -= box.x\r\n    y -= box.y\r\n\r\n    if (!isNaN(x) && !isNaN(y)) {\r\n      // move every point\r\n      for (var l, i = this.value.length - 1; i >= 0; i--) {\r\n        l = this.value[i][0]\r\n\r\n        if (l == 'M' || l == 'L' || l == 'T')  {\r\n          this.value[i][1] += x\r\n          this.value[i][2] += y\r\n\r\n        } else if (l == 'H')  {\r\n          this.value[i][1] += x\r\n\r\n        } else if (l == 'V')  {\r\n          this.value[i][1] += y\r\n\r\n        } else if (l == 'C' || l == 'S' || l == 'Q')  {\r\n          this.value[i][1] += x\r\n          this.value[i][2] += y\r\n          this.value[i][3] += x\r\n          this.value[i][4] += y\r\n\r\n          if (l == 'C')  {\r\n            this.value[i][5] += x\r\n            this.value[i][6] += y\r\n          }\r\n\r\n        } else if (l == 'A')  {\r\n          this.value[i][6] += x\r\n          this.value[i][7] += y\r\n        }\r\n\r\n      }\r\n    }\r\n\r\n    return this\r\n  }\r\n  // Resize path string\r\n, size: function(width, height) {\r\n    // get bounding box of current situation\r\n    var i, l, box = this.bbox()\r\n\r\n    // recalculate position of all points according to new size\r\n    for (i = this.value.length - 1; i >= 0; i--) {\r\n      l = this.value[i][0]\r\n\r\n      if (l == 'M' || l == 'L' || l == 'T')  {\r\n        this.value[i][1] = ((this.value[i][1] - box.x) * width)  / box.width  + box.x\r\n        this.value[i][2] = ((this.value[i][2] - box.y) * height) / box.height + box.y\r\n\r\n      } else if (l == 'H')  {\r\n        this.value[i][1] = ((this.value[i][1] - box.x) * width)  / box.width  + box.x\r\n\r\n      } else if (l == 'V')  {\r\n        this.value[i][1] = ((this.value[i][1] - box.y) * height) / box.height + box.y\r\n\r\n      } else if (l == 'C' || l == 'S' || l == 'Q')  {\r\n        this.value[i][1] = ((this.value[i][1] - box.x) * width)  / box.width  + box.x\r\n        this.value[i][2] = ((this.value[i][2] - box.y) * height) / box.height + box.y\r\n        this.value[i][3] = ((this.value[i][3] - box.x) * width)  / box.width  + box.x\r\n        this.value[i][4] = ((this.value[i][4] - box.y) * height) / box.height + box.y\r\n\r\n        if (l == 'C')  {\r\n          this.value[i][5] = ((this.value[i][5] - box.x) * width)  / box.width  + box.x\r\n          this.value[i][6] = ((this.value[i][6] - box.y) * height) / box.height + box.y\r\n        }\r\n\r\n      } else if (l == 'A')  {\r\n        // resize radii\r\n        this.value[i][1] = (this.value[i][1] * width)  / box.width\r\n        this.value[i][2] = (this.value[i][2] * height) / box.height\r\n\r\n        // move position values\r\n        this.value[i][6] = ((this.value[i][6] - box.x) * width)  / box.width  + box.x\r\n        this.value[i][7] = ((this.value[i][7] - box.y) * height) / box.height + box.y\r\n      }\r\n\r\n    }\r\n\r\n    return this\r\n  }\r\n  // Test if the passed path array use the same path data commands as this path array\r\n, equalCommands: function(pathArray) {\r\n    var i, il, equalCommands\r\n\r\n    pathArray = new SVG.PathArray(pathArray)\r\n\r\n    equalCommands = this.value.length === pathArray.value.length\r\n    for(i = 0, il = this.value.length; equalCommands && i < il; i++) {\r\n      equalCommands = this.value[i][0] === pathArray.value[i][0]\r\n    }\r\n\r\n    return equalCommands\r\n  }\r\n  // Make path array morphable\r\n, morph: function(pathArray) {\r\n    pathArray = new SVG.PathArray(pathArray)\r\n\r\n    if(this.equalCommands(pathArray)) {\r\n      this.destination = pathArray\r\n    } else {\r\n      this.destination = null\r\n    }\r\n\r\n    return this\r\n  }\r\n  // Get morphed path array at given position\r\n, at: function(pos) {\r\n    // make sure a destination is defined\r\n    if (!this.destination) return this\r\n\r\n    var sourceArray = this.value\r\n      , destinationArray = this.destination.value\r\n      , array = [], pathArray = new SVG.PathArray()\r\n      , i, il, j, jl\r\n\r\n    // Animate has specified in the SVG spec\r\n    // See: https://www.w3.org/TR/SVG11/paths.html#PathElement\r\n    for (i = 0, il = sourceArray.length; i < il; i++) {\r\n      array[i] = [sourceArray[i][0]]\r\n      for(j = 1, jl = sourceArray[i].length; j < jl; j++) {\r\n        array[i][j] = sourceArray[i][j] + (destinationArray[i][j] - sourceArray[i][j]) * pos\r\n      }\r\n      // For the two flags of the elliptical arc command, the SVG spec say:\r\n      // Flags and booleans are interpolated as fractions between zero and one, with any non-zero value considered to be a value of one/true\r\n      // Elliptical arc command as an array followed by corresponding indexes:\r\n      // ['A', rx, ry, x-axis-rotation, large-arc-flag, sweep-flag, x, y]\r\n      //   0    1   2        3                 4             5      6  7\r\n      if(array[i][0] === 'A') {\r\n        array[i][4] = +(array[i][4] != 0)\r\n        array[i][5] = +(array[i][5] != 0)\r\n      }\r\n    }\r\n\r\n    // Directly modify the value of a path array, this is done this way for performance\r\n    pathArray.value = array\r\n    return pathArray\r\n  }\r\n  // Absolutize and parse path to array\r\n, parse: function(array) {\r\n    // if it's already a patharray, no need to parse it\r\n    if (array instanceof SVG.PathArray) return array.valueOf()\r\n\r\n    // prepare for parsing\r\n    var i, x0, y0, s, seg, arr\r\n      , x = 0\r\n      , y = 0\r\n      , paramCnt = { 'M':2, 'L':2, 'H':1, 'V':1, 'C':6, 'S':4, 'Q':4, 'T':2, 'A':7, 'Z':0 }\r\n\r\n    if(typeof array == 'string'){\r\n\r\n      array = array\r\n        .replace(SVG.regex.numbersWithDots, pathRegReplace) // convert 45.123.123 to 45.123 .123\r\n        .replace(SVG.regex.pathLetters, ' $& ') // put some room between letters and numbers\r\n        .replace(SVG.regex.hyphen, '$1 -')      // add space before hyphen\r\n        .trim()                                 // trim\r\n        .split(SVG.regex.delimiter)   // split into array\r\n\r\n    }else{\r\n      array = array.reduce(function(prev, curr){\r\n        return [].concat.call(prev, curr)\r\n      }, [])\r\n    }\r\n\r\n    // array now is an array containing all parts of a path e.g. ['M', '0', '0', 'L', '30', '30' ...]\r\n    var arr = []\r\n      , p = new SVG.Point()\r\n      , p0 = new SVG.Point()\r\n      , index = 0\r\n      , len = array.length\r\n\r\n    do{\r\n      // Test if we have a path letter\r\n      if(SVG.regex.isPathLetter.test(array[index])){\r\n        s = array[index]\r\n        ++index\r\n      // If last letter was a move command and we got no new, it defaults to [L]ine\r\n      }else if(s == 'M'){\r\n        s = 'L'\r\n      }else if(s == 'm'){\r\n        s = 'l'\r\n      }\r\n\r\n      arr.push(pathHandlers[s].call(null,\r\n          array.slice(index, (index = index + paramCnt[s.toUpperCase()])).map(parseFloat),\r\n          p, p0\r\n        )\r\n      )\r\n\r\n    }while(len > index)\r\n\r\n    return arr\r\n\r\n  }\r\n  // Get bounding box of path\r\n, bbox: function() {\r\n    SVG.parser.path.setAttribute('d', this.toString())\r\n\r\n    return SVG.parser.path.getBBox()\r\n  }\r\n\r\n})\r\n\n// Module for unit convertions\r\nSVG.Number = SVG.invent({\r\n  // Initialize\r\n  create: function(value, unit) {\r\n    // initialize defaults\r\n    this.value = 0\r\n    this.unit  = unit || ''\r\n\r\n    // parse value\r\n    if (typeof value === 'number') {\r\n      // ensure a valid numeric value\r\n      this.value = isNaN(value) ? 0 : !isFinite(value) ? (value < 0 ? -3.4e+38 : +3.4e+38) : value\r\n\r\n    } else if (typeof value === 'string') {\r\n      unit = value.match(SVG.regex.numberAndUnit)\r\n\r\n      if (unit) {\r\n        // make value numeric\r\n        this.value = parseFloat(unit[1])\r\n\r\n        // normalize\r\n        if (unit[5] == '%')\r\n          this.value /= 100\r\n        else if (unit[5] == 's')\r\n          this.value *= 1000\r\n\r\n        // store unit\r\n        this.unit = unit[5]\r\n      }\r\n\r\n    } else {\r\n      if (value instanceof SVG.Number) {\r\n        this.value = value.valueOf()\r\n        this.unit  = value.unit\r\n      }\r\n    }\r\n\r\n  }\r\n  // Add methods\r\n, extend: {\r\n    // Stringalize\r\n    toString: function() {\r\n      return (\r\n        this.unit == '%' ?\r\n          ~~(this.value * 1e8) / 1e6:\r\n        this.unit == 's' ?\r\n          this.value / 1e3 :\r\n          this.value\r\n      ) + this.unit\r\n    }\r\n  , toJSON: function() {\r\n      return this.toString()\r\n    }\r\n  , // Convert to primitive\r\n    valueOf: function() {\r\n      return this.value\r\n    }\r\n    // Add number\r\n  , plus: function(number) {\r\n      number = new SVG.Number(number)\r\n      return new SVG.Number(this + number, this.unit || number.unit)\r\n    }\r\n    // Subtract number\r\n  , minus: function(number) {\r\n      number = new SVG.Number(number)\r\n      return new SVG.Number(this - number, this.unit || number.unit)\r\n    }\r\n    // Multiply number\r\n  , times: function(number) {\r\n      number = new SVG.Number(number)\r\n      return new SVG.Number(this * number, this.unit || number.unit)\r\n    }\r\n    // Divide number\r\n  , divide: function(number) {\r\n      number = new SVG.Number(number)\r\n      return new SVG.Number(this / number, this.unit || number.unit)\r\n    }\r\n    // Convert to different unit\r\n  , to: function(unit) {\r\n      var number = new SVG.Number(this)\r\n\r\n      if (typeof unit === 'string')\r\n        number.unit = unit\r\n\r\n      return number\r\n    }\r\n    // Make number morphable\r\n  , morph: function(number) {\r\n      this.destination = new SVG.Number(number)\r\n\r\n      if(number.relative) {\r\n        this.destination.value += this.value\r\n      }\r\n\r\n      return this\r\n    }\r\n    // Get morphed number at given position\r\n  , at: function(pos) {\r\n      // Make sure a destination is defined\r\n      if (!this.destination) return this\r\n\r\n      // Generate new morphed number\r\n      return new SVG.Number(this.destination)\r\n          .minus(this)\r\n          .times(pos)\r\n          .plus(this)\r\n    }\r\n\r\n  }\r\n})\r\n\n\r\nSVG.Element = SVG.invent({\r\n  // Initialize node\r\n  create: function(node) {\r\n    // make stroke value accessible dynamically\r\n    this._stroke = SVG.defaults.attrs.stroke\r\n    this._event = null\r\n\r\n    // initialize data object\r\n    this.dom = {}\r\n\r\n    // create circular reference\r\n    if (this.node = node) {\r\n      this.type = node.nodeName\r\n      this.node.instance = this\r\n\r\n      // store current attribute value\r\n      this._stroke = node.getAttribute('stroke') || this._stroke\r\n    }\r\n  }\r\n\r\n  // Add class methods\r\n, extend: {\r\n    // Move over x-axis\r\n    x: function(x) {\r\n      return this.attr('x', x)\r\n    }\r\n    // Move over y-axis\r\n  , y: function(y) {\r\n      return this.attr('y', y)\r\n    }\r\n    // Move by center over x-axis\r\n  , cx: function(x) {\r\n      return x == null ? this.x() + this.width() / 2 : this.x(x - this.width() / 2)\r\n    }\r\n    // Move by center over y-axis\r\n  , cy: function(y) {\r\n      return y == null ? this.y() + this.height() / 2 : this.y(y - this.height() / 2)\r\n    }\r\n    // Move element to given x and y values\r\n  , move: function(x, y) {\r\n      return this.x(x).y(y)\r\n    }\r\n    // Move element by its center\r\n  , center: function(x, y) {\r\n      return this.cx(x).cy(y)\r\n    }\r\n    // Set width of element\r\n  , width: function(width) {\r\n      return this.attr('width', width)\r\n    }\r\n    // Set height of element\r\n  , height: function(height) {\r\n      return this.attr('height', height)\r\n    }\r\n    // Set element size to given width and height\r\n  , size: function(width, height) {\r\n      var p = proportionalSize(this, width, height)\r\n\r\n      return this\r\n        .width(new SVG.Number(p.width))\r\n        .height(new SVG.Number(p.height))\r\n    }\r\n    // Clone element\r\n  , clone: function(parent, withData) {\r\n      // write dom data to the dom so the clone can pickup the data\r\n      this.writeDataToDom()\r\n\r\n      // clone element and assign new id\r\n      var clone = assignNewId(this.node.cloneNode(true))\r\n\r\n      // insert the clone in the given parent or after myself\r\n      if(parent) parent.add(clone)\r\n      else this.after(clone)\r\n\r\n      return clone\r\n    }\r\n    // Remove element\r\n  , remove: function() {\r\n      if (this.parent())\r\n        this.parent().removeElement(this)\r\n\r\n      return this\r\n    }\r\n    // Replace element\r\n  , replace: function(element) {\r\n      this.after(element).remove()\r\n\r\n      return element\r\n    }\r\n    // Add element to given container and return self\r\n  , addTo: function(parent) {\r\n      return parent.put(this)\r\n    }\r\n    // Add element to given container and return container\r\n  , putIn: function(parent) {\r\n      return parent.add(this)\r\n    }\r\n    // Get / set id\r\n  , id: function(id) {\r\n      return this.attr('id', id)\r\n    }\r\n    // Checks whether the given point inside the bounding box of the element\r\n  , inside: function(x, y) {\r\n      var box = this.bbox()\r\n\r\n      return x > box.x\r\n          && y > box.y\r\n          && x < box.x + box.width\r\n          && y < box.y + box.height\r\n    }\r\n    // Show element\r\n  , show: function() {\r\n      return this.style('display', '')\r\n    }\r\n    // Hide element\r\n  , hide: function() {\r\n      return this.style('display', 'none')\r\n    }\r\n    // Is element visible?\r\n  , visible: function() {\r\n      return this.style('display') != 'none'\r\n    }\r\n    // Return id on string conversion\r\n  , toString: function() {\r\n      return this.attr('id')\r\n    }\r\n    // Return array of classes on the node\r\n  , classes: function() {\r\n      var attr = this.attr('class')\r\n\r\n      return attr == null ? [] : attr.trim().split(SVG.regex.delimiter)\r\n    }\r\n    // Return true if class exists on the node, false otherwise\r\n  , hasClass: function(name) {\r\n      return this.classes().indexOf(name) != -1\r\n    }\r\n    // Add class to the node\r\n  , addClass: function(name) {\r\n      if (!this.hasClass(name)) {\r\n        var array = this.classes()\r\n        array.push(name)\r\n        this.attr('class', array.join(' '))\r\n      }\r\n\r\n      return this\r\n    }\r\n    // Remove class from the node\r\n  , removeClass: function(name) {\r\n      if (this.hasClass(name)) {\r\n        this.attr('class', this.classes().filter(function(c) {\r\n          return c != name\r\n        }).join(' '))\r\n      }\r\n\r\n      return this\r\n    }\r\n    // Toggle the presence of a class on the node\r\n  , toggleClass: function(name) {\r\n      return this.hasClass(name) ? this.removeClass(name) : this.addClass(name)\r\n    }\r\n    // Get referenced element form attribute value\r\n  , reference: function(attr) {\r\n      return SVG.get(this.attr(attr))\r\n    }\r\n    // Returns the parent element instance\r\n  , parent: function(type) {\r\n      var parent = this\r\n\r\n      // check for parent\r\n      if(!parent.node.parentNode) return null\r\n\r\n      // get parent element\r\n      parent = SVG.adopt(parent.node.parentNode)\r\n\r\n      if(!type) return parent\r\n\r\n      // loop trough ancestors if type is given\r\n      while(parent && parent.node instanceof window.SVGElement){\r\n        if(typeof type === 'string' ? parent.matches(type) : parent instanceof type) return parent\r\n        if(parent.node.parentNode.nodeName == '#document') return null // #720\r\n        parent = SVG.adopt(parent.node.parentNode)\r\n      }\r\n    }\r\n    // Get parent document\r\n  , doc: function() {\r\n      return this instanceof SVG.Doc ? this : this.parent(SVG.Doc)\r\n    }\r\n    // return array of all ancestors of given type up to the root svg\r\n  , parents: function(type) {\r\n      var parents = [], parent = this\r\n\r\n      do{\r\n        parent = parent.parent(type)\r\n        if(!parent || !parent.node) break\r\n\r\n        parents.push(parent)\r\n      } while(parent.parent)\r\n\r\n      return parents\r\n    }\r\n    // matches the element vs a css selector\r\n  , matches: function(selector){\r\n      return matches(this.node, selector)\r\n    }\r\n    // Returns the svg node to call native svg methods on it\r\n  , native: function() {\r\n      return this.node\r\n    }\r\n    // Import raw svg\r\n  , svg: function(svg) {\r\n      // create temporary holder\r\n      var well = document.createElement('svg')\r\n\r\n      // act as a setter if svg is given\r\n      if (svg && this instanceof SVG.Parent) {\r\n        // dump raw svg\r\n        well.innerHTML = '<svg>' + svg.replace(/\\n/, '').replace(/<(\\w+)([^<]+?)\\/>/g, '<$1$2></$1>') + '</svg>'\r\n\r\n        // transplant nodes\r\n        for (var i = 0, il = well.firstChild.childNodes.length; i < il; i++)\r\n          this.node.appendChild(well.firstChild.firstChild)\r\n\r\n      // otherwise act as a getter\r\n      } else {\r\n        // create a wrapping svg element in case of partial content\r\n        well.appendChild(svg = document.createElement('svg'))\r\n\r\n        // write svgjs data to the dom\r\n        this.writeDataToDom()\r\n\r\n        // insert a copy of this node\r\n        svg.appendChild(this.node.cloneNode(true))\r\n\r\n        // return target element\r\n        return well.innerHTML.replace(/^<svg>/, '').replace(/<\\/svg>$/, '')\r\n      }\r\n\r\n      return this\r\n    }\r\n  // write svgjs data to the dom\r\n  , writeDataToDom: function() {\r\n\r\n      // dump variables recursively\r\n      if(this.each || this.lines){\r\n        var fn = this.each ? this : this.lines();\r\n        fn.each(function(){\r\n          this.writeDataToDom()\r\n        })\r\n      }\r\n\r\n      // remove previously set data\r\n      this.node.removeAttribute('svgjs:data')\r\n\r\n      if(Object.keys(this.dom).length)\r\n        this.node.setAttribute('svgjs:data', JSON.stringify(this.dom)) // see #428\r\n\r\n      return this\r\n    }\r\n  // set given data to the elements data property\r\n  , setData: function(o){\r\n      this.dom = o\r\n      return this\r\n    }\r\n  , is: function(obj){\r\n      return is(this, obj)\r\n    }\r\n  }\r\n})\r\n\nSVG.easing = {\r\n  '-': function(pos){return pos}\r\n, '<>':function(pos){return -Math.cos(pos * Math.PI) / 2 + 0.5}\r\n, '>': function(pos){return  Math.sin(pos * Math.PI / 2)}\r\n, '<': function(pos){return -Math.cos(pos * Math.PI / 2) + 1}\r\n}\r\n\r\nSVG.morph = function(pos){\r\n  return function(from, to) {\r\n    return new SVG.MorphObj(from, to).at(pos)\r\n  }\r\n}\r\n\r\nSVG.Situation = SVG.invent({\r\n\r\n  create: function(o){\r\n    this.init = false\r\n    this.reversed = false\r\n    this.reversing = false\r\n\r\n    this.duration = new SVG.Number(o.duration).valueOf()\r\n    this.delay = new SVG.Number(o.delay).valueOf()\r\n\r\n    this.start = +new Date() + this.delay\r\n    this.finish = this.start + this.duration\r\n    this.ease = o.ease\r\n\r\n    // this.loop is incremented from 0 to this.loops\r\n    // it is also incremented when in an infinite loop (when this.loops is true)\r\n    this.loop = 0\r\n    this.loops = false\r\n\r\n    this.animations = {\r\n      // functionToCall: [list of morphable objects]\r\n      // e.g. move: [SVG.Number, SVG.Number]\r\n    }\r\n\r\n    this.attrs = {\r\n      // holds all attributes which are not represented from a function svg.js provides\r\n      // e.g. someAttr: SVG.Number\r\n    }\r\n\r\n    this.styles = {\r\n      // holds all styles which should be animated\r\n      // e.g. fill-color: SVG.Color\r\n    }\r\n\r\n    this.transforms = [\r\n      // holds all transformations as transformation objects\r\n      // e.g. [SVG.Rotate, SVG.Translate, SVG.Matrix]\r\n    ]\r\n\r\n    this.once = {\r\n      // functions to fire at a specific position\r\n      // e.g. \"0.5\": function foo(){}\r\n    }\r\n\r\n  }\r\n\r\n})\r\n\r\n\r\nSVG.FX = SVG.invent({\r\n\r\n  create: function(element) {\r\n    this._target = element\r\n    this.situations = []\r\n    this.active = false\r\n    this.situation = null\r\n    this.paused = false\r\n    this.lastPos = 0\r\n    this.pos = 0\r\n    // The absolute position of an animation is its position in the context of its complete duration (including delay and loops)\r\n    // When performing a delay, absPos is below 0 and when performing a loop, its value is above 1\r\n    this.absPos = 0\r\n    this._speed = 1\r\n  }\r\n\r\n, extend: {\r\n\r\n    /**\r\n     * sets or returns the target of this animation\r\n     * @param o object || number In case of Object it holds all parameters. In case of number its the duration of the animation\r\n     * @param ease function || string Function which should be used for easing or easing keyword\r\n     * @param delay Number indicating the delay before the animation starts\r\n     * @return target || this\r\n     */\r\n    animate: function(o, ease, delay){\r\n\r\n      if(typeof o == 'object'){\r\n        ease = o.ease\r\n        delay = o.delay\r\n        o = o.duration\r\n      }\r\n\r\n      var situation = new SVG.Situation({\r\n        duration: o || 1000,\r\n        delay: delay || 0,\r\n        ease: SVG.easing[ease || '-'] || ease\r\n      })\r\n\r\n      this.queue(situation)\r\n\r\n      return this\r\n    }\r\n\r\n    /**\r\n     * sets a delay before the next element of the queue is called\r\n     * @param delay Duration of delay in milliseconds\r\n     * @return this.target()\r\n     */\r\n  , delay: function(delay){\r\n      // The delay is performed by an empty situation with its duration\r\n      // attribute set to the duration of the delay\r\n      var situation = new SVG.Situation({\r\n        duration: delay,\r\n        delay: 0,\r\n        ease: SVG.easing['-']\r\n      })\r\n\r\n      return this.queue(situation)\r\n    }\r\n\r\n    /**\r\n     * sets or returns the target of this animation\r\n     * @param null || target SVG.Element which should be set as new target\r\n     * @return target || this\r\n     */\r\n  , target: function(target){\r\n      if(target && target instanceof SVG.Element){\r\n        this._target = target\r\n        return this\r\n      }\r\n\r\n      return this._target\r\n    }\r\n\r\n    // returns the absolute position at a given time\r\n  , timeToAbsPos: function(timestamp){\r\n      return (timestamp - this.situation.start) / (this.situation.duration/this._speed)\r\n    }\r\n\r\n    // returns the timestamp from a given absolute positon\r\n  , absPosToTime: function(absPos){\r\n      return this.situation.duration/this._speed * absPos + this.situation.start\r\n    }\r\n\r\n    // starts the animationloop\r\n  , startAnimFrame: function(){\r\n      this.stopAnimFrame()\r\n      this.animationFrame = window.requestAnimationFrame(function(){ this.step() }.bind(this))\r\n    }\r\n\r\n    // cancels the animationframe\r\n  , stopAnimFrame: function(){\r\n      window.cancelAnimationFrame(this.animationFrame)\r\n    }\r\n\r\n    // kicks off the animation - only does something when the queue is currently not active and at least one situation is set\r\n  , start: function(){\r\n      // dont start if already started\r\n      if(!this.active && this.situation){\r\n        this.active = true\r\n        this.startCurrent()\r\n      }\r\n\r\n      return this\r\n    }\r\n\r\n    // start the current situation\r\n  , startCurrent: function(){\r\n      this.situation.start = +new Date + this.situation.delay/this._speed\r\n      this.situation.finish = this.situation.start + this.situation.duration/this._speed\r\n      return this.initAnimations().step()\r\n    }\r\n\r\n    /**\r\n     * adds a function / Situation to the animation queue\r\n     * @param fn function / situation to add\r\n     * @return this\r\n     */\r\n  , queue: function(fn){\r\n      if(typeof fn == 'function' || fn instanceof SVG.Situation)\r\n        this.situations.push(fn)\r\n\r\n      if(!this.situation) this.situation = this.situations.shift()\r\n\r\n      return this\r\n    }\r\n\r\n    /**\r\n     * pulls next element from the queue and execute it\r\n     * @return this\r\n     */\r\n  , dequeue: function(){\r\n      // stop current animation\r\n      this.stop()\r\n\r\n      // get next animation from queue\r\n      this.situation = this.situations.shift()\r\n\r\n      if(this.situation){\r\n        if(this.situation instanceof SVG.Situation) {\r\n          this.start()\r\n        } else {\r\n          // If it is not a SVG.Situation, then it is a function, we execute it\r\n          this.situation.call(this)\r\n        }\r\n      }\r\n\r\n      return this\r\n    }\r\n\r\n    // updates all animations to the current state of the element\r\n    // this is important when one property could be changed from another property\r\n  , initAnimations: function() {\r\n      var i, j, source\r\n      var s = this.situation\r\n\r\n      if(s.init) return this\r\n\r\n      for(i in s.animations){\r\n        source = this.target()[i]()\r\n\r\n        if(!Array.isArray(source)) {\r\n          source = [source]\r\n        }\r\n\r\n        if(!Array.isArray(s.animations[i])) {\r\n          s.animations[i] = [s.animations[i]]\r\n        }\r\n\r\n        //if(s.animations[i].length > source.length) {\r\n        //  source.concat = source.concat(s.animations[i].slice(source.length, s.animations[i].length))\r\n        //}\r\n\r\n        for(j = source.length; j--;) {\r\n          // The condition is because some methods return a normal number instead\r\n          // of a SVG.Number\r\n          if(s.animations[i][j] instanceof SVG.Number)\r\n            source[j] = new SVG.Number(source[j])\r\n\r\n          s.animations[i][j] = source[j].morph(s.animations[i][j])\r\n        }\r\n      }\r\n\r\n      for(i in s.attrs){\r\n        s.attrs[i] = new SVG.MorphObj(this.target().attr(i), s.attrs[i])\r\n      }\r\n\r\n      for(i in s.styles){\r\n        s.styles[i] = new SVG.MorphObj(this.target().style(i), s.styles[i])\r\n      }\r\n\r\n      s.initialTransformation = this.target().matrixify()\r\n\r\n      s.init = true\r\n      return this\r\n    }\r\n  , clearQueue: function(){\r\n      this.situations = []\r\n      return this\r\n    }\r\n  , clearCurrent: function(){\r\n      this.situation = null\r\n      return this\r\n    }\r\n    /** stops the animation immediately\r\n     * @param jumpToEnd A Boolean indicating whether to complete the current animation immediately.\r\n     * @param clearQueue A Boolean indicating whether to remove queued animation as well.\r\n     * @return this\r\n     */\r\n  , stop: function(jumpToEnd, clearQueue){\r\n      var active = this.active\r\n      this.active = false\r\n\r\n      if(clearQueue){\r\n        this.clearQueue()\r\n      }\r\n\r\n      if(jumpToEnd && this.situation){\r\n        // initialize the situation if it was not\r\n        !active && this.startCurrent()\r\n        this.atEnd()\r\n      }\r\n\r\n      this.stopAnimFrame()\r\n\r\n      return this.clearCurrent()\r\n    }\r\n\r\n    /** resets the element to the state where the current element has started\r\n     * @return this\r\n     */\r\n  , reset: function(){\r\n      if(this.situation){\r\n        var temp = this.situation\r\n        this.stop()\r\n        this.situation = temp\r\n        this.atStart()\r\n      }\r\n      return this\r\n    }\r\n\r\n    // Stop the currently-running animation, remove all queued animations, and complete all animations for the element.\r\n  , finish: function(){\r\n\r\n      this.stop(true, false)\r\n\r\n      while(this.dequeue().situation && this.stop(true, false));\r\n\r\n      this.clearQueue().clearCurrent()\r\n\r\n      return this\r\n    }\r\n\r\n    // set the internal animation pointer at the start position, before any loops, and updates the visualisation\r\n  , atStart: function() {\r\n      return this.at(0, true)\r\n    }\r\n\r\n    // set the internal animation pointer at the end position, after all the loops, and updates the visualisation\r\n  , atEnd: function() {\r\n      if (this.situation.loops === true) {\r\n        // If in a infinite loop, we end the current iteration\r\n        this.situation.loops = this.situation.loop + 1\r\n      }\r\n\r\n      if(typeof this.situation.loops == 'number') {\r\n        // If performing a finite number of loops, we go after all the loops\r\n        return this.at(this.situation.loops, true)\r\n      } else {\r\n        // If no loops, we just go at the end\r\n        return this.at(1, true)\r\n      }\r\n    }\r\n\r\n    // set the internal animation pointer to the specified position and updates the visualisation\r\n    // if isAbsPos is true, pos is treated as an absolute position\r\n  , at: function(pos, isAbsPos){\r\n      var durDivSpd = this.situation.duration/this._speed\r\n\r\n      this.absPos = pos\r\n      // If pos is not an absolute position, we convert it into one\r\n      if (!isAbsPos) {\r\n        if (this.situation.reversed) this.absPos = 1 - this.absPos\r\n        this.absPos += this.situation.loop\r\n      }\r\n\r\n      this.situation.start = +new Date - this.absPos * durDivSpd\r\n      this.situation.finish = this.situation.start + durDivSpd\r\n\r\n      return this.step(true)\r\n    }\r\n\r\n    /**\r\n     * sets or returns the speed of the animations\r\n     * @param speed null || Number The new speed of the animations\r\n     * @return Number || this\r\n     */\r\n  , speed: function(speed){\r\n      if (speed === 0) return this.pause()\r\n\r\n      if (speed) {\r\n        this._speed = speed\r\n        // We use an absolute position here so that speed can affect the delay before the animation\r\n        return this.at(this.absPos, true)\r\n      } else return this._speed\r\n    }\r\n\r\n    // Make loopable\r\n  , loop: function(times, reverse) {\r\n      var c = this.last()\r\n\r\n      // store total loops\r\n      c.loops = (times != null) ? times : true\r\n      c.loop = 0\r\n\r\n      if(reverse) c.reversing = true\r\n      return this\r\n    }\r\n\r\n    // pauses the animation\r\n  , pause: function(){\r\n      this.paused = true\r\n      this.stopAnimFrame()\r\n\r\n      return this\r\n    }\r\n\r\n    // unpause the animation\r\n  , play: function(){\r\n      if(!this.paused) return this\r\n      this.paused = false\r\n      // We use an absolute position here so that the delay before the animation can be paused\r\n      return this.at(this.absPos, true)\r\n    }\r\n\r\n    /**\r\n     * toggle or set the direction of the animation\r\n     * true sets direction to backwards while false sets it to forwards\r\n     * @param reversed Boolean indicating whether to reverse the animation or not (default: toggle the reverse status)\r\n     * @return this\r\n     */\r\n  , reverse: function(reversed){\r\n      var c = this.last()\r\n\r\n      if(typeof reversed == 'undefined') c.reversed = !c.reversed\r\n      else c.reversed = reversed\r\n\r\n      return this\r\n    }\r\n\r\n\r\n    /**\r\n     * returns a float from 0-1 indicating the progress of the current animation\r\n     * @param eased Boolean indicating whether the returned position should be eased or not\r\n     * @return number\r\n     */\r\n  , progress: function(easeIt){\r\n      return easeIt ? this.situation.ease(this.pos) : this.pos\r\n    }\r\n\r\n    /**\r\n     * adds a callback function which is called when the current animation is finished\r\n     * @param fn Function which should be executed as callback\r\n     * @return number\r\n     */\r\n  , after: function(fn){\r\n      var c = this.last()\r\n        , wrapper = function wrapper(e){\r\n            if(e.detail.situation == c){\r\n              fn.call(this, c)\r\n              this.off('finished.fx', wrapper) // prevent memory leak\r\n            }\r\n          }\r\n\r\n      this.target().on('finished.fx', wrapper)\r\n\r\n      return this._callStart()\r\n    }\r\n\r\n    // adds a callback which is called whenever one animation step is performed\r\n  , during: function(fn){\r\n      var c = this.last()\r\n        , wrapper = function(e){\r\n            if(e.detail.situation == c){\r\n              fn.call(this, e.detail.pos, SVG.morph(e.detail.pos), e.detail.eased, c)\r\n            }\r\n          }\r\n\r\n      // see above\r\n      this.target().off('during.fx', wrapper).on('during.fx', wrapper)\r\n\r\n      this.after(function(){\r\n        this.off('during.fx', wrapper)\r\n      })\r\n\r\n      return this._callStart()\r\n    }\r\n\r\n    // calls after ALL animations in the queue are finished\r\n  , afterAll: function(fn){\r\n      var wrapper = function wrapper(e){\r\n            fn.call(this)\r\n            this.off('allfinished.fx', wrapper)\r\n          }\r\n\r\n      // see above\r\n      this.target().off('allfinished.fx', wrapper).on('allfinished.fx', wrapper)\r\n\r\n      return this._callStart()\r\n    }\r\n\r\n    // calls on every animation step for all animations\r\n  , duringAll: function(fn){\r\n      var wrapper = function(e){\r\n            fn.call(this, e.detail.pos, SVG.morph(e.detail.pos), e.detail.eased, e.detail.situation)\r\n          }\r\n\r\n      this.target().off('during.fx', wrapper).on('during.fx', wrapper)\r\n\r\n      this.afterAll(function(){\r\n        this.off('during.fx', wrapper)\r\n      })\r\n\r\n      return this._callStart()\r\n    }\r\n\r\n  , last: function(){\r\n      return this.situations.length ? this.situations[this.situations.length-1] : this.situation\r\n    }\r\n\r\n    // adds one property to the animations\r\n  , add: function(method, args, type){\r\n      this.last()[type || 'animations'][method] = args\r\n      return this._callStart()\r\n    }\r\n\r\n    /** perform one step of the animation\r\n     *  @param ignoreTime Boolean indicating whether to ignore time and use position directly or recalculate position based on time\r\n     *  @return this\r\n     */\r\n  , step: function(ignoreTime){\r\n\r\n      // convert current time to an absolute position\r\n      if(!ignoreTime) this.absPos = this.timeToAbsPos(+new Date)\r\n\r\n      // This part convert an absolute position to a position\r\n      if(this.situation.loops !== false) {\r\n        var absPos, absPosInt, lastLoop\r\n\r\n        // If the absolute position is below 0, we just treat it as if it was 0\r\n        absPos = Math.max(this.absPos, 0)\r\n        absPosInt = Math.floor(absPos)\r\n\r\n        if(this.situation.loops === true || absPosInt < this.situation.loops) {\r\n          this.pos = absPos - absPosInt\r\n          lastLoop = this.situation.loop\r\n          this.situation.loop = absPosInt\r\n        } else {\r\n          this.absPos = this.situation.loops\r\n          this.pos = 1\r\n          // The -1 here is because we don't want to toggle reversed when all the loops have been completed\r\n          lastLoop = this.situation.loop - 1\r\n          this.situation.loop = this.situation.loops\r\n        }\r\n\r\n        if(this.situation.reversing) {\r\n          // Toggle reversed if an odd number of loops as occured since the last call of step\r\n          this.situation.reversed = this.situation.reversed != Boolean((this.situation.loop - lastLoop) % 2)\r\n        }\r\n\r\n      } else {\r\n        // If there are no loop, the absolute position must not be above 1\r\n        this.absPos = Math.min(this.absPos, 1)\r\n        this.pos = this.absPos\r\n      }\r\n\r\n      // while the absolute position can be below 0, the position must not be below 0\r\n      if(this.pos < 0) this.pos = 0\r\n\r\n      if(this.situation.reversed) this.pos = 1 - this.pos\r\n\r\n\r\n      // apply easing\r\n      var eased = this.situation.ease(this.pos)\r\n\r\n      // call once-callbacks\r\n      for(var i in this.situation.once){\r\n        if(i > this.lastPos && i <= eased){\r\n          this.situation.once[i].call(this.target(), this.pos, eased)\r\n          delete this.situation.once[i]\r\n        }\r\n      }\r\n\r\n      // fire during callback with position, eased position and current situation as parameter\r\n      if(this.active) this.target().fire('during', {pos: this.pos, eased: eased, fx: this, situation: this.situation})\r\n\r\n      // the user may call stop or finish in the during callback\r\n      // so make sure that we still have a valid situation\r\n      if(!this.situation){\r\n        return this\r\n      }\r\n\r\n      // apply the actual animation to every property\r\n      this.eachAt()\r\n\r\n      // do final code when situation is finished\r\n      if((this.pos == 1 && !this.situation.reversed) || (this.situation.reversed && this.pos == 0)){\r\n\r\n        // stop animation callback\r\n        this.stopAnimFrame()\r\n\r\n        // fire finished callback with current situation as parameter\r\n        this.target().fire('finished', {fx:this, situation: this.situation})\r\n\r\n        if(!this.situations.length){\r\n          this.target().fire('allfinished')\r\n\r\n          // Recheck the length since the user may call animate in the afterAll callback\r\n          if(!this.situations.length){\r\n            this.target().off('.fx') // there shouldnt be any binding left, but to make sure...\r\n            this.active = false\r\n          }\r\n        }\r\n\r\n        // start next animation\r\n        if(this.active) this.dequeue()\r\n        else this.clearCurrent()\r\n\r\n      }else if(!this.paused && this.active){\r\n        // we continue animating when we are not at the end\r\n        this.startAnimFrame()\r\n      }\r\n\r\n      // save last eased position for once callback triggering\r\n      this.lastPos = eased\r\n      return this\r\n\r\n    }\r\n\r\n    // calculates the step for every property and calls block with it\r\n  , eachAt: function(){\r\n      var i, len, at, self = this, target = this.target(), s = this.situation\r\n\r\n      // apply animations which can be called trough a method\r\n      for(i in s.animations){\r\n\r\n        at = [].concat(s.animations[i]).map(function(el){\r\n          return typeof el !== 'string' && el.at ? el.at(s.ease(self.pos), self.pos) : el\r\n        })\r\n\r\n        target[i].apply(target, at)\r\n\r\n      }\r\n\r\n      // apply animation which has to be applied with attr()\r\n      for(i in s.attrs){\r\n\r\n        at = [i].concat(s.attrs[i]).map(function(el){\r\n          return typeof el !== 'string' && el.at ? el.at(s.ease(self.pos), self.pos) : el\r\n        })\r\n\r\n        target.attr.apply(target, at)\r\n\r\n      }\r\n\r\n      // apply animation which has to be applied with style()\r\n      for(i in s.styles){\r\n\r\n        at = [i].concat(s.styles[i]).map(function(el){\r\n          return typeof el !== 'string' && el.at ? el.at(s.ease(self.pos), self.pos) : el\r\n        })\r\n\r\n        target.style.apply(target, at)\r\n\r\n      }\r\n\r\n      // animate initialTransformation which has to be chained\r\n      if(s.transforms.length){\r\n\r\n        // get initial initialTransformation\r\n        at = s.initialTransformation\r\n        for(i = 0, len = s.transforms.length; i < len; i++){\r\n\r\n          // get next transformation in chain\r\n          var a = s.transforms[i]\r\n\r\n          // multiply matrix directly\r\n          if(a instanceof SVG.Matrix){\r\n\r\n            if(a.relative){\r\n              at = at.multiply(new SVG.Matrix().morph(a).at(s.ease(this.pos)))\r\n            }else{\r\n              at = at.morph(a).at(s.ease(this.pos))\r\n            }\r\n            continue\r\n          }\r\n\r\n          // when transformation is absolute we have to reset the needed transformation first\r\n          if(!a.relative)\r\n            a.undo(at.extract())\r\n\r\n          // and reapply it after\r\n          at = at.multiply(a.at(s.ease(this.pos)))\r\n\r\n        }\r\n\r\n        // set new matrix on element\r\n        target.matrix(at)\r\n      }\r\n\r\n      return this\r\n\r\n    }\r\n\r\n\r\n    // adds an once-callback which is called at a specific position and never again\r\n  , once: function(pos, fn, isEased){\r\n      var c = this.last()\r\n      if(!isEased) pos = c.ease(pos)\r\n\r\n      c.once[pos] = fn\r\n\r\n      return this\r\n    }\r\n\r\n  , _callStart: function() {\r\n      setTimeout(function(){this.start()}.bind(this), 0)\r\n      return this\r\n    }\r\n\r\n  }\r\n\r\n, parent: SVG.Element\r\n\r\n  // Add method to parent elements\r\n, construct: {\r\n    // Get fx module or create a new one, then animate with given duration and ease\r\n    animate: function(o, ease, delay) {\r\n      return (this.fx || (this.fx = new SVG.FX(this))).animate(o, ease, delay)\r\n    }\r\n  , delay: function(delay){\r\n      return (this.fx || (this.fx = new SVG.FX(this))).delay(delay)\r\n    }\r\n  , stop: function(jumpToEnd, clearQueue) {\r\n      if (this.fx)\r\n        this.fx.stop(jumpToEnd, clearQueue)\r\n\r\n      return this\r\n    }\r\n  , finish: function() {\r\n      if (this.fx)\r\n        this.fx.finish()\r\n\r\n      return this\r\n    }\r\n    // Pause current animation\r\n  , pause: function() {\r\n      if (this.fx)\r\n        this.fx.pause()\r\n\r\n      return this\r\n    }\r\n    // Play paused current animation\r\n  , play: function() {\r\n      if (this.fx)\r\n        this.fx.play()\r\n\r\n      return this\r\n    }\r\n    // Set/Get the speed of the animations\r\n  , speed: function(speed) {\r\n      if (this.fx)\r\n        if (speed == null)\r\n          return this.fx.speed()\r\n        else\r\n          this.fx.speed(speed)\r\n\r\n      return this\r\n    }\r\n  }\r\n\r\n})\r\n\r\n// MorphObj is used whenever no morphable object is given\r\nSVG.MorphObj = SVG.invent({\r\n\r\n  create: function(from, to){\r\n    // prepare color for morphing\r\n    if(SVG.Color.isColor(to)) return new SVG.Color(from).morph(to)\r\n    // prepare value list for morphing\r\n    if(SVG.regex.delimiter.test(from)) return new SVG.Array(from).morph(to)\r\n    // prepare number for morphing\r\n    if(SVG.regex.numberAndUnit.test(to)) return new SVG.Number(from).morph(to)\r\n\r\n    // prepare for plain morphing\r\n    this.value = from\r\n    this.destination = to\r\n  }\r\n\r\n, extend: {\r\n    at: function(pos, real){\r\n      return real < 1 ? this.value : this.destination\r\n    },\r\n\r\n    valueOf: function(){\r\n      return this.value\r\n    }\r\n  }\r\n\r\n})\r\n\r\nSVG.extend(SVG.FX, {\r\n  // Add animatable attributes\r\n  attr: function(a, v, relative) {\r\n    // apply attributes individually\r\n    if (typeof a == 'object') {\r\n      for (var key in a)\r\n        this.attr(key, a[key])\r\n\r\n    } else {\r\n      this.add(a, v, 'attrs')\r\n    }\r\n\r\n    return this\r\n  }\r\n  // Add animatable styles\r\n, style: function(s, v) {\r\n    if (typeof s == 'object')\r\n      for (var key in s)\r\n        this.style(key, s[key])\r\n\r\n    else\r\n      this.add(s, v, 'styles')\r\n\r\n    return this\r\n  }\r\n  // Animatable x-axis\r\n, x: function(x, relative) {\r\n    if(this.target() instanceof SVG.G){\r\n      this.transform({x:x}, relative)\r\n      return this\r\n    }\r\n\r\n    var num = new SVG.Number(x)\r\n    num.relative = relative\r\n    return this.add('x', num)\r\n  }\r\n  // Animatable y-axis\r\n, y: function(y, relative) {\r\n    if(this.target() instanceof SVG.G){\r\n      this.transform({y:y}, relative)\r\n      return this\r\n    }\r\n\r\n    var num = new SVG.Number(y)\r\n    num.relative = relative\r\n    return this.add('y', num)\r\n  }\r\n  // Animatable center x-axis\r\n, cx: function(x) {\r\n    return this.add('cx', new SVG.Number(x))\r\n  }\r\n  // Animatable center y-axis\r\n, cy: function(y) {\r\n    return this.add('cy', new SVG.Number(y))\r\n  }\r\n  // Add animatable move\r\n, move: function(x, y) {\r\n    return this.x(x).y(y)\r\n  }\r\n  // Add animatable center\r\n, center: function(x, y) {\r\n    return this.cx(x).cy(y)\r\n  }\r\n  // Add animatable size\r\n, size: function(width, height) {\r\n    if (this.target() instanceof SVG.Text) {\r\n      // animate font size for Text elements\r\n      this.attr('font-size', width)\r\n\r\n    } else {\r\n      // animate bbox based size for all other elements\r\n      var box\r\n\r\n      if(!width || !height){\r\n        box = this.target().bbox()\r\n      }\r\n\r\n      if(!width){\r\n        width = box.width / box.height  * height\r\n      }\r\n\r\n      if(!height){\r\n        height = box.height / box.width  * width\r\n      }\r\n\r\n      this.add('width' , new SVG.Number(width))\r\n          .add('height', new SVG.Number(height))\r\n\r\n    }\r\n\r\n    return this\r\n  }\r\n  // Add animatable width\r\n, width: function(width) {\r\n    return this.add('width', new SVG.Number(width))\r\n  }\r\n  // Add animatable height\r\n, height: function(height) {\r\n    return this.add('height', new SVG.Number(height))\r\n  }\r\n  // Add animatable plot\r\n, plot: function(a, b, c, d) {\r\n    // Lines can be plotted with 4 arguments\r\n    if(arguments.length == 4) {\r\n      return this.plot([a, b, c, d])\r\n    }\r\n\r\n    return this.add('plot', new (this.target().morphArray)(a))\r\n  }\r\n  // Add leading method\r\n, leading: function(value) {\r\n    return this.target().leading ?\r\n      this.add('leading', new SVG.Number(value)) :\r\n      this\r\n  }\r\n  // Add animatable viewbox\r\n, viewbox: function(x, y, width, height) {\r\n    if (this.target() instanceof SVG.Container) {\r\n      this.add('viewbox', new SVG.ViewBox(x, y, width, height))\r\n    }\r\n\r\n    return this\r\n  }\r\n, update: function(o) {\r\n    if (this.target() instanceof SVG.Stop) {\r\n      if (typeof o == 'number' || o instanceof SVG.Number) {\r\n        return this.update({\r\n          offset:  arguments[0]\r\n        , color:   arguments[1]\r\n        , opacity: arguments[2]\r\n        })\r\n      }\r\n\r\n      if (o.opacity != null) this.attr('stop-opacity', o.opacity)\r\n      if (o.color   != null) this.attr('stop-color', o.color)\r\n      if (o.offset  != null) this.attr('offset', o.offset)\r\n    }\r\n\r\n    return this\r\n  }\r\n})\r\n\nSVG.Box = SVG.invent({\r\n  create: function(x, y, width, height) {\r\n    if (typeof x == 'object' && !(x instanceof SVG.Element)) {\r\n      // chromes getBoundingClientRect has no x and y property\r\n      return SVG.Box.call(this, x.left != null ? x.left : x.x , x.top != null ? x.top : x.y, x.width, x.height)\r\n    } else if (arguments.length == 4) {\r\n      this.x = x\r\n      this.y = y\r\n      this.width = width\r\n      this.height = height\r\n    }\r\n\r\n    // add center, right, bottom...\r\n    fullBox(this)\r\n  }\r\n, extend: {\r\n    // Merge rect box with another, return a new instance\r\n    merge: function(box) {\r\n      var b = new this.constructor()\r\n\r\n      // merge boxes\r\n      b.x      = Math.min(this.x, box.x)\r\n      b.y      = Math.min(this.y, box.y)\r\n      b.width  = Math.max(this.x + this.width,  box.x + box.width)  - b.x\r\n      b.height = Math.max(this.y + this.height, box.y + box.height) - b.y\r\n\r\n      return fullBox(b)\r\n    }\r\n\r\n  , transform: function(m) {\r\n      var xMin = Infinity, xMax = -Infinity, yMin = Infinity, yMax = -Infinity, p, bbox\r\n\r\n      var pts = [\r\n        new SVG.Point(this.x, this.y),\r\n        new SVG.Point(this.x2, this.y),\r\n        new SVG.Point(this.x, this.y2),\r\n        new SVG.Point(this.x2, this.y2)\r\n      ]\r\n\r\n      pts.forEach(function(p) {\r\n        p = p.transform(m)\r\n        xMin = Math.min(xMin,p.x)\r\n        xMax = Math.max(xMax,p.x)\r\n        yMin = Math.min(yMin,p.y)\r\n        yMax = Math.max(yMax,p.y)\r\n      })\r\n\r\n      bbox = new this.constructor()\r\n      bbox.x = xMin\r\n      bbox.width = xMax-xMin\r\n      bbox.y = yMin\r\n      bbox.height = yMax-yMin\r\n\r\n      fullBox(bbox)\r\n\r\n      return bbox\r\n    }\r\n  }\r\n})\r\n\r\nSVG.BBox = SVG.invent({\r\n  // Initialize\r\n  create: function(element) {\r\n    SVG.Box.apply(this, [].slice.call(arguments))\r\n\r\n    // get values if element is given\r\n    if (element instanceof SVG.Element) {\r\n      var box\r\n\r\n      // yes this is ugly, but Firefox can be a bitch when it comes to elements that are not yet rendered\r\n      try {\r\n\r\n        if (!document.documentElement.contains){\r\n          // This is IE - it does not support contains() for top-level SVGs\r\n          var topParent = element.node\r\n          while (topParent.parentNode){\r\n            topParent = topParent.parentNode\r\n          }\r\n          if (topParent != document) throw new Exception('Element not in the dom')\r\n        } else {\r\n          // the element is NOT in the dom, throw error\r\n          if(!document.documentElement.contains(element.node)) throw new Exception('Element not in the dom')\r\n        }\r\n\r\n        // find native bbox\r\n        box = element.node.getBBox()\r\n      } catch(e) {\r\n        if(element instanceof SVG.Shape){\r\n          var clone = element.clone(SVG.parser.draw.instance).show()\r\n          box = clone.node.getBBox()\r\n          clone.remove()\r\n        }else{\r\n          box = {\r\n            x:      element.node.clientLeft\r\n          , y:      element.node.clientTop\r\n          , width:  element.node.clientWidth\r\n          , height: element.node.clientHeight\r\n          }\r\n        }\r\n      }\r\n\r\n      SVG.Box.call(this, box)\r\n    }\r\n\r\n  }\r\n\r\n  // Define ancestor\r\n, inherit: SVG.Box\r\n\r\n  // Define Parent\r\n, parent: SVG.Element\r\n\r\n  // Constructor\r\n, construct: {\r\n    // Get bounding box\r\n    bbox: function() {\r\n      return new SVG.BBox(this)\r\n    }\r\n  }\r\n\r\n})\r\n\r\nSVG.BBox.prototype.constructor = SVG.BBox\r\n\r\n\r\nSVG.extend(SVG.Element, {\r\n  tbox: function(){\r\n    console.warn('Use of TBox is deprecated and mapped to RBox. Use .rbox() instead.')\r\n    return this.rbox(this.doc())\r\n  }\r\n})\r\n\r\nSVG.RBox = SVG.invent({\r\n  // Initialize\r\n  create: function(element) {\r\n    SVG.Box.apply(this, [].slice.call(arguments))\r\n\r\n    if (element instanceof SVG.Element) {\r\n      SVG.Box.call(this, element.node.getBoundingClientRect())\r\n    }\r\n  }\r\n\r\n, inherit: SVG.Box\r\n\r\n  // define Parent\r\n, parent: SVG.Element\r\n\r\n, extend: {\r\n    addOffset: function() {\r\n      // offset by window scroll position, because getBoundingClientRect changes when window is scrolled\r\n      this.x += window.pageXOffset\r\n      this.y += window.pageYOffset\r\n      return this\r\n    }\r\n  }\r\n\r\n  // Constructor\r\n, construct: {\r\n    // Get rect box\r\n    rbox: function(el) {\r\n      if (el) return new SVG.RBox(this).transform(el.screenCTM().inverse())\r\n      return new SVG.RBox(this).addOffset()\r\n    }\r\n  }\r\n\r\n})\r\n\r\nSVG.RBox.prototype.constructor = SVG.RBox\r\n\nSVG.Matrix = SVG.invent({\r\n  // Initialize\r\n  create: function(source) {\r\n    var i, base = arrayToMatrix([1, 0, 0, 1, 0, 0])\r\n\r\n    // ensure source as object\r\n    source = source instanceof SVG.Element ?\r\n      source.matrixify() :\r\n    typeof source === 'string' ?\r\n      arrayToMatrix(source.split(SVG.regex.delimiter).map(parseFloat)) :\r\n    arguments.length == 6 ?\r\n      arrayToMatrix([].slice.call(arguments)) :\r\n    Array.isArray(source) ?\r\n      arrayToMatrix(source) :\r\n    typeof source === 'object' ?\r\n      source : base\r\n\r\n    // merge source\r\n    for (i = abcdef.length - 1; i >= 0; --i)\r\n      this[abcdef[i]] = source[abcdef[i]] != null ?\r\n        source[abcdef[i]] : base[abcdef[i]]\r\n  }\r\n\r\n  // Add methods\r\n, extend: {\r\n    // Extract individual transformations\r\n    extract: function() {\r\n      // find delta transform points\r\n      var px    = deltaTransformPoint(this, 0, 1)\r\n        , py    = deltaTransformPoint(this, 1, 0)\r\n        , skewX = 180 / Math.PI * Math.atan2(px.y, px.x) - 90\r\n\r\n      return {\r\n        // translation\r\n        x:        this.e\r\n      , y:        this.f\r\n      , transformedX:(this.e * Math.cos(skewX * Math.PI / 180) + this.f * Math.sin(skewX * Math.PI / 180)) / Math.sqrt(this.a * this.a + this.b * this.b)\r\n      , transformedY:(this.f * Math.cos(skewX * Math.PI / 180) + this.e * Math.sin(-skewX * Math.PI / 180)) / Math.sqrt(this.c * this.c + this.d * this.d)\r\n        // skew\r\n      , skewX:    -skewX\r\n      , skewY:    180 / Math.PI * Math.atan2(py.y, py.x)\r\n        // scale\r\n      , scaleX:   Math.sqrt(this.a * this.a + this.b * this.b)\r\n      , scaleY:   Math.sqrt(this.c * this.c + this.d * this.d)\r\n        // rotation\r\n      , rotation: skewX\r\n      , a: this.a\r\n      , b: this.b\r\n      , c: this.c\r\n      , d: this.d\r\n      , e: this.e\r\n      , f: this.f\r\n      , matrix: new SVG.Matrix(this)\r\n      }\r\n    }\r\n    // Clone matrix\r\n  , clone: function() {\r\n      return new SVG.Matrix(this)\r\n    }\r\n    // Morph one matrix into another\r\n  , morph: function(matrix) {\r\n      // store new destination\r\n      this.destination = new SVG.Matrix(matrix)\r\n\r\n      return this\r\n    }\r\n    // Get morphed matrix at a given position\r\n  , at: function(pos) {\r\n      // make sure a destination is defined\r\n      if (!this.destination) return this\r\n\r\n      // calculate morphed matrix at a given position\r\n      var matrix = new SVG.Matrix({\r\n        a: this.a + (this.destination.a - this.a) * pos\r\n      , b: this.b + (this.destination.b - this.b) * pos\r\n      , c: this.c + (this.destination.c - this.c) * pos\r\n      , d: this.d + (this.destination.d - this.d) * pos\r\n      , e: this.e + (this.destination.e - this.e) * pos\r\n      , f: this.f + (this.destination.f - this.f) * pos\r\n      })\r\n\r\n      return matrix\r\n    }\r\n    // Multiplies by given matrix\r\n  , multiply: function(matrix) {\r\n      return new SVG.Matrix(this.native().multiply(parseMatrix(matrix).native()))\r\n    }\r\n    // Inverses matrix\r\n  , inverse: function() {\r\n      return new SVG.Matrix(this.native().inverse())\r\n    }\r\n    // Translate matrix\r\n  , translate: function(x, y) {\r\n      return new SVG.Matrix(this.native().translate(x || 0, y || 0))\r\n    }\r\n    // Scale matrix\r\n  , scale: function(x, y, cx, cy) {\r\n      // support uniformal scale\r\n      if (arguments.length == 1) {\r\n        y = x\r\n      } else if (arguments.length == 3) {\r\n        cy = cx\r\n        cx = y\r\n        y = x\r\n      }\r\n\r\n      return this.around(cx, cy, new SVG.Matrix(x, 0, 0, y, 0, 0))\r\n    }\r\n    // Rotate matrix\r\n  , rotate: function(r, cx, cy) {\r\n      // convert degrees to radians\r\n      r = SVG.utils.radians(r)\r\n\r\n      return this.around(cx, cy, new SVG.Matrix(Math.cos(r), Math.sin(r), -Math.sin(r), Math.cos(r), 0, 0))\r\n    }\r\n    // Flip matrix on x or y, at a given offset\r\n  , flip: function(a, o) {\r\n      return a == 'x' ?\r\n          this.scale(-1, 1, o, 0) :\r\n        a == 'y' ?\r\n          this.scale(1, -1, 0, o) :\r\n          this.scale(-1, -1, a, o != null ? o : a)\r\n    }\r\n    // Skew\r\n  , skew: function(x, y, cx, cy) {\r\n      // support uniformal skew\r\n      if (arguments.length == 1) {\r\n        y = x\r\n      } else if (arguments.length == 3) {\r\n        cy = cx\r\n        cx = y\r\n        y = x\r\n      }\r\n\r\n      // convert degrees to radians\r\n      x = SVG.utils.radians(x)\r\n      y = SVG.utils.radians(y)\r\n\r\n      return this.around(cx, cy, new SVG.Matrix(1, Math.tan(y), Math.tan(x), 1, 0, 0))\r\n    }\r\n    // SkewX\r\n  , skewX: function(x, cx, cy) {\r\n      return this.skew(x, 0, cx, cy)\r\n    }\r\n    // SkewY\r\n  , skewY: function(y, cx, cy) {\r\n      return this.skew(0, y, cx, cy)\r\n    }\r\n    // Transform around a center point\r\n  , around: function(cx, cy, matrix) {\r\n      return this\r\n        .multiply(new SVG.Matrix(1, 0, 0, 1, cx || 0, cy || 0))\r\n        .multiply(matrix)\r\n        .multiply(new SVG.Matrix(1, 0, 0, 1, -cx || 0, -cy || 0))\r\n    }\r\n    // Convert to native SVGMatrix\r\n  , native: function() {\r\n      // create new matrix\r\n      var matrix = SVG.parser.native.createSVGMatrix()\r\n\r\n      // update with current values\r\n      for (var i = abcdef.length - 1; i >= 0; i--)\r\n        matrix[abcdef[i]] = this[abcdef[i]]\r\n\r\n      return matrix\r\n    }\r\n    // Convert matrix to string\r\n  , toString: function() {\r\n      return 'matrix(' + this.a + ',' + this.b + ',' + this.c + ',' + this.d + ',' + this.e + ',' + this.f + ')'\r\n    }\r\n  }\r\n\r\n  // Define parent\r\n, parent: SVG.Element\r\n\r\n  // Add parent method\r\n, construct: {\r\n    // Get current matrix\r\n    ctm: function() {\r\n      return new SVG.Matrix(this.node.getCTM())\r\n    },\r\n    // Get current screen matrix\r\n    screenCTM: function() {\r\n      /* https://bugzilla.mozilla.org/show_bug.cgi?id=1344537\r\n         This is needed because FF does not return the transformation matrix\r\n         for the inner coordinate system when getScreenCTM() is called on nested svgs.\r\n         However all other Browsers do that */\r\n      if(this instanceof SVG.Nested) {\r\n        var rect = this.rect(1,1)\r\n        var m = rect.node.getScreenCTM()\r\n        rect.remove()\r\n        return new SVG.Matrix(m)\r\n      }\r\n      return new SVG.Matrix(this.node.getScreenCTM())\r\n    }\r\n\r\n  }\r\n\r\n})\r\n\nSVG.Point = SVG.invent({\r\n  // Initialize\r\n  create: function(x,y) {\r\n    var i, source, base = {x:0, y:0}\r\n\r\n    // ensure source as object\r\n    source = Array.isArray(x) ?\r\n      {x:x[0], y:x[1]} :\r\n    typeof x === 'object' ?\r\n      {x:x.x, y:x.y} :\r\n    x != null ?\r\n      {x:x, y:(y != null ? y : x)} : base // If y has no value, then x is used has its value\r\n\r\n    // merge source\r\n    this.x = source.x\r\n    this.y = source.y\r\n  }\r\n\r\n  // Add methods\r\n, extend: {\r\n    // Clone point\r\n    clone: function() {\r\n      return new SVG.Point(this)\r\n    }\r\n    // Morph one point into another\r\n  , morph: function(x, y) {\r\n      // store new destination\r\n      this.destination = new SVG.Point(x, y)\r\n\r\n      return this\r\n    }\r\n    // Get morphed point at a given position\r\n  , at: function(pos) {\r\n      // make sure a destination is defined\r\n      if (!this.destination) return this\r\n\r\n      // calculate morphed matrix at a given position\r\n      var point = new SVG.Point({\r\n        x: this.x + (this.destination.x - this.x) * pos\r\n      , y: this.y + (this.destination.y - this.y) * pos\r\n      })\r\n\r\n      return point\r\n    }\r\n    // Convert to native SVGPoint\r\n  , native: function() {\r\n      // create new point\r\n      var point = SVG.parser.native.createSVGPoint()\r\n\r\n      // update with current values\r\n      point.x = this.x\r\n      point.y = this.y\r\n\r\n      return point\r\n    }\r\n    // transform point with matrix\r\n  , transform: function(matrix) {\r\n      return new SVG.Point(this.native().matrixTransform(matrix.native()))\r\n    }\r\n\r\n  }\r\n\r\n})\r\n\r\nSVG.extend(SVG.Element, {\r\n\r\n  // Get point\r\n  point: function(x, y) {\r\n    return new SVG.Point(x,y).transform(this.screenCTM().inverse());\r\n  }\r\n\r\n})\r\n\nSVG.extend(SVG.Element, {\r\n  // Set svg element attribute\r\n  attr: function(a, v, n) {\r\n    // act as full getter\r\n    if (a == null) {\r\n      // get an object of attributes\r\n      a = {}\r\n      v = this.node.attributes\r\n      for (n = v.length - 1; n >= 0; n--)\r\n        a[v[n].nodeName] = SVG.regex.isNumber.test(v[n].nodeValue) ? parseFloat(v[n].nodeValue) : v[n].nodeValue\r\n\r\n      return a\r\n\r\n    } else if (typeof a == 'object') {\r\n      // apply every attribute individually if an object is passed\r\n      for (v in a) this.attr(v, a[v])\r\n\r\n    } else if (v === null) {\r\n        // remove value\r\n        this.node.removeAttribute(a)\r\n\r\n    } else if (v == null) {\r\n      // act as a getter if the first and only argument is not an object\r\n      v = this.node.getAttribute(a)\r\n      return v == null ?\r\n        SVG.defaults.attrs[a] :\r\n      SVG.regex.isNumber.test(v) ?\r\n        parseFloat(v) : v\r\n\r\n    } else {\r\n      // BUG FIX: some browsers will render a stroke if a color is given even though stroke width is 0\r\n      if (a == 'stroke-width')\r\n        this.attr('stroke', parseFloat(v) > 0 ? this._stroke : null)\r\n      else if (a == 'stroke')\r\n        this._stroke = v\r\n\r\n      // convert image fill and stroke to patterns\r\n      if (a == 'fill' || a == 'stroke') {\r\n        if (SVG.regex.isImage.test(v))\r\n          v = this.doc().defs().image(v, 0, 0)\r\n\r\n        if (v instanceof SVG.Image)\r\n          v = this.doc().defs().pattern(0, 0, function() {\r\n            this.add(v)\r\n          })\r\n      }\r\n\r\n      // ensure correct numeric values (also accepts NaN and Infinity)\r\n      if (typeof v === 'number')\r\n        v = new SVG.Number(v)\r\n\r\n      // ensure full hex color\r\n      else if (SVG.Color.isColor(v))\r\n        v = new SVG.Color(v)\r\n\r\n      // parse array values\r\n      else if (Array.isArray(v))\r\n        v = new SVG.Array(v)\r\n\r\n      // if the passed attribute is leading...\r\n      if (a == 'leading') {\r\n        // ... call the leading method instead\r\n        if (this.leading)\r\n          this.leading(v)\r\n      } else {\r\n        // set given attribute on node\r\n        typeof n === 'string' ?\r\n          this.node.setAttributeNS(n, a, v.toString()) :\r\n          this.node.setAttribute(a, v.toString())\r\n      }\r\n\r\n      // rebuild if required\r\n      if (this.rebuild && (a == 'font-size' || a == 'x'))\r\n        this.rebuild(a, v)\r\n    }\r\n\r\n    return this\r\n  }\r\n})\nSVG.extend(SVG.Element, {\r\n  // Add transformations\r\n  transform: function(o, relative) {\r\n    // get target in case of the fx module, otherwise reference this\r\n    var target = this\r\n      , matrix, bbox\r\n\r\n    // act as a getter\r\n    if (typeof o !== 'object') {\r\n      // get current matrix\r\n      matrix = new SVG.Matrix(target).extract()\r\n\r\n      return typeof o === 'string' ? matrix[o] : matrix\r\n    }\r\n\r\n    // get current matrix\r\n    matrix = new SVG.Matrix(target)\r\n\r\n    // ensure relative flag\r\n    relative = !!relative || !!o.relative\r\n\r\n    // act on matrix\r\n    if (o.a != null) {\r\n      matrix = relative ?\r\n        // relative\r\n        matrix.multiply(new SVG.Matrix(o)) :\r\n        // absolute\r\n        new SVG.Matrix(o)\r\n\r\n    // act on rotation\r\n    } else if (o.rotation != null) {\r\n      // ensure centre point\r\n      ensureCentre(o, target)\r\n\r\n      // apply transformation\r\n      matrix = relative ?\r\n        // relative\r\n        matrix.rotate(o.rotation, o.cx, o.cy) :\r\n        // absolute\r\n        matrix.rotate(o.rotation - matrix.extract().rotation, o.cx, o.cy)\r\n\r\n    // act on scale\r\n    } else if (o.scale != null || o.scaleX != null || o.scaleY != null) {\r\n      // ensure centre point\r\n      ensureCentre(o, target)\r\n\r\n      // ensure scale values on both axes\r\n      o.scaleX = o.scale != null ? o.scale : o.scaleX != null ? o.scaleX : 1\r\n      o.scaleY = o.scale != null ? o.scale : o.scaleY != null ? o.scaleY : 1\r\n\r\n      if (!relative) {\r\n        // absolute; multiply inversed values\r\n        var e = matrix.extract()\r\n        o.scaleX = o.scaleX * 1 / e.scaleX\r\n        o.scaleY = o.scaleY * 1 / e.scaleY\r\n      }\r\n\r\n      matrix = matrix.scale(o.scaleX, o.scaleY, o.cx, o.cy)\r\n\r\n    // act on skew\r\n    } else if (o.skew != null || o.skewX != null || o.skewY != null) {\r\n      // ensure centre point\r\n      ensureCentre(o, target)\r\n\r\n      // ensure skew values on both axes\r\n      o.skewX = o.skew != null ? o.skew : o.skewX != null ? o.skewX : 0\r\n      o.skewY = o.skew != null ? o.skew : o.skewY != null ? o.skewY : 0\r\n\r\n      if (!relative) {\r\n        // absolute; reset skew values\r\n        var e = matrix.extract()\r\n        matrix = matrix.multiply(new SVG.Matrix().skew(e.skewX, e.skewY, o.cx, o.cy).inverse())\r\n      }\r\n\r\n      matrix = matrix.skew(o.skewX, o.skewY, o.cx, o.cy)\r\n\r\n    // act on flip\r\n    } else if (o.flip) {\r\n      if(o.flip == 'x' || o.flip == 'y') {\r\n        o.offset = o.offset == null ? target.bbox()['c' + o.flip] : o.offset\r\n      } else {\r\n        if(o.offset == null) {\r\n          bbox = target.bbox()\r\n          o.flip = bbox.cx\r\n          o.offset = bbox.cy\r\n        } else {\r\n          o.flip = o.offset\r\n        }\r\n      }\r\n\r\n      matrix = new SVG.Matrix().flip(o.flip, o.offset)\r\n\r\n    // act on translate\r\n    } else if (o.x != null || o.y != null) {\r\n      if (relative) {\r\n        // relative\r\n        matrix = matrix.translate(o.x, o.y)\r\n      } else {\r\n        // absolute\r\n        if (o.x != null) matrix.e = o.x\r\n        if (o.y != null) matrix.f = o.y\r\n      }\r\n    }\r\n\r\n    return this.attr('transform', matrix)\r\n  }\r\n})\r\n\r\nSVG.extend(SVG.FX, {\r\n  transform: function(o, relative) {\r\n    // get target in case of the fx module, otherwise reference this\r\n    var target = this.target()\r\n      , matrix, bbox\r\n\r\n    // act as a getter\r\n    if (typeof o !== 'object') {\r\n      // get current matrix\r\n      matrix = new SVG.Matrix(target).extract()\r\n\r\n      return typeof o === 'string' ? matrix[o] : matrix\r\n    }\r\n\r\n    // ensure relative flag\r\n    relative = !!relative || !!o.relative\r\n\r\n    // act on matrix\r\n    if (o.a != null) {\r\n      matrix = new SVG.Matrix(o)\r\n\r\n    // act on rotation\r\n    } else if (o.rotation != null) {\r\n      // ensure centre point\r\n      ensureCentre(o, target)\r\n\r\n      // apply transformation\r\n      matrix = new SVG.Rotate(o.rotation, o.cx, o.cy)\r\n\r\n    // act on scale\r\n    } else if (o.scale != null || o.scaleX != null || o.scaleY != null) {\r\n      // ensure centre point\r\n      ensureCentre(o, target)\r\n\r\n      // ensure scale values on both axes\r\n      o.scaleX = o.scale != null ? o.scale : o.scaleX != null ? o.scaleX : 1\r\n      o.scaleY = o.scale != null ? o.scale : o.scaleY != null ? o.scaleY : 1\r\n\r\n      matrix = new SVG.Scale(o.scaleX, o.scaleY, o.cx, o.cy)\r\n\r\n    // act on skew\r\n    } else if (o.skewX != null || o.skewY != null) {\r\n      // ensure centre point\r\n      ensureCentre(o, target)\r\n\r\n      // ensure skew values on both axes\r\n      o.skewX = o.skewX != null ? o.skewX : 0\r\n      o.skewY = o.skewY != null ? o.skewY : 0\r\n\r\n      matrix = new SVG.Skew(o.skewX, o.skewY, o.cx, o.cy)\r\n\r\n    // act on flip\r\n    } else if (o.flip) {\r\n      if(o.flip == 'x' || o.flip == 'y') {\r\n        o.offset = o.offset == null ? target.bbox()['c' + o.flip] : o.offset\r\n      } else {\r\n        if(o.offset == null) {\r\n          bbox = target.bbox()\r\n          o.flip = bbox.cx\r\n          o.offset = bbox.cy\r\n        } else {\r\n          o.flip = o.offset\r\n        }\r\n      }\r\n\r\n      matrix = new SVG.Matrix().flip(o.flip, o.offset)\r\n\r\n    // act on translate\r\n    } else if (o.x != null || o.y != null) {\r\n      matrix = new SVG.Translate(o.x, o.y)\r\n    }\r\n\r\n    if(!matrix) return this\r\n\r\n    matrix.relative = relative\r\n\r\n    this.last().transforms.push(matrix)\r\n\r\n    return this._callStart()\r\n  }\r\n})\r\n\r\nSVG.extend(SVG.Element, {\r\n  // Reset all transformations\r\n  untransform: function() {\r\n    return this.attr('transform', null)\r\n  },\r\n  // merge the whole transformation chain into one matrix and returns it\r\n  matrixify: function() {\r\n\r\n    var matrix = (this.attr('transform') || '')\r\n      // split transformations\r\n      .split(SVG.regex.transforms).slice(0,-1).map(function(str){\r\n        // generate key => value pairs\r\n        var kv = str.trim().split('(')\r\n        return [kv[0], kv[1].split(SVG.regex.delimiter).map(function(str){ return parseFloat(str) })]\r\n      })\r\n      // merge every transformation into one matrix\r\n      .reduce(function(matrix, transform){\r\n\r\n        if(transform[0] == 'matrix') return matrix.multiply(arrayToMatrix(transform[1]))\r\n        return matrix[transform[0]].apply(matrix, transform[1])\r\n\r\n      }, new SVG.Matrix())\r\n\r\n    return matrix\r\n  },\r\n  // add an element to another parent without changing the visual representation on the screen\r\n  toParent: function(parent) {\r\n    if(this == parent) return this\r\n    var ctm = this.screenCTM()\r\n    var pCtm = parent.screenCTM().inverse()\r\n\r\n    this.addTo(parent).untransform().transform(pCtm.multiply(ctm))\r\n\r\n    return this\r\n  },\r\n  // same as above with parent equals root-svg\r\n  toDoc: function() {\r\n    return this.toParent(this.doc())\r\n  }\r\n\r\n})\r\n\r\nSVG.Transformation = SVG.invent({\r\n\r\n  create: function(source, inversed){\r\n\r\n    if(arguments.length > 1 && typeof inversed != 'boolean'){\r\n      return this.constructor.call(this, [].slice.call(arguments))\r\n    }\r\n\r\n    if(Array.isArray(source)){\r\n      for(var i = 0, len = this.arguments.length; i < len; ++i){\r\n        this[this.arguments[i]] = source[i]\r\n      }\r\n    } else if(typeof source == 'object'){\r\n      for(var i = 0, len = this.arguments.length; i < len; ++i){\r\n        this[this.arguments[i]] = source[this.arguments[i]]\r\n      }\r\n    }\r\n\r\n    this.inversed = false\r\n\r\n    if(inversed === true){\r\n      this.inversed = true\r\n    }\r\n\r\n  }\r\n\r\n, extend: {\r\n\r\n    arguments: []\r\n  , method: ''\r\n\r\n  , at: function(pos){\r\n\r\n      var params = []\r\n\r\n      for(var i = 0, len = this.arguments.length; i < len; ++i){\r\n        params.push(this[this.arguments[i]])\r\n      }\r\n\r\n      var m = this._undo || new SVG.Matrix()\r\n\r\n      m = new SVG.Matrix().morph(SVG.Matrix.prototype[this.method].apply(m, params)).at(pos)\r\n\r\n      return this.inversed ? m.inverse() : m\r\n\r\n    }\r\n\r\n  , undo: function(o){\r\n      for(var i = 0, len = this.arguments.length; i < len; ++i){\r\n        o[this.arguments[i]] = typeof this[this.arguments[i]] == 'undefined' ? 0 : o[this.arguments[i]]\r\n      }\r\n\r\n      // The method SVG.Matrix.extract which was used before calling this\r\n      // method to obtain a value for the parameter o doesn't return a cx and\r\n      // a cy so we use the ones that were provided to this object at its creation\r\n      o.cx = this.cx\r\n      o.cy = this.cy\r\n\r\n      this._undo = new SVG[capitalize(this.method)](o, true).at(1)\r\n\r\n      return this\r\n    }\r\n\r\n  }\r\n\r\n})\r\n\r\nSVG.Translate = SVG.invent({\r\n\r\n  parent: SVG.Matrix\r\n, inherit: SVG.Transformation\r\n\r\n, create: function(source, inversed){\r\n    this.constructor.apply(this, [].slice.call(arguments))\r\n  }\r\n\r\n, extend: {\r\n    arguments: ['transformedX', 'transformedY']\r\n  , method: 'translate'\r\n  }\r\n\r\n})\r\n\r\nSVG.Rotate = SVG.invent({\r\n\r\n  parent: SVG.Matrix\r\n, inherit: SVG.Transformation\r\n\r\n, create: function(source, inversed){\r\n    this.constructor.apply(this, [].slice.call(arguments))\r\n  }\r\n\r\n, extend: {\r\n    arguments: ['rotation', 'cx', 'cy']\r\n  , method: 'rotate'\r\n  , at: function(pos){\r\n      var m = new SVG.Matrix().rotate(new SVG.Number().morph(this.rotation - (this._undo ? this._undo.rotation : 0)).at(pos), this.cx, this.cy)\r\n      return this.inversed ? m.inverse() : m\r\n    }\r\n  , undo: function(o){\r\n      this._undo = o\r\n      return this\r\n    }\r\n  }\r\n\r\n})\r\n\r\nSVG.Scale = SVG.invent({\r\n\r\n  parent: SVG.Matrix\r\n, inherit: SVG.Transformation\r\n\r\n, create: function(source, inversed){\r\n    this.constructor.apply(this, [].slice.call(arguments))\r\n  }\r\n\r\n, extend: {\r\n    arguments: ['scaleX', 'scaleY', 'cx', 'cy']\r\n  , method: 'scale'\r\n  }\r\n\r\n})\r\n\r\nSVG.Skew = SVG.invent({\r\n\r\n  parent: SVG.Matrix\r\n, inherit: SVG.Transformation\r\n\r\n, create: function(source, inversed){\r\n    this.constructor.apply(this, [].slice.call(arguments))\r\n  }\r\n\r\n, extend: {\r\n    arguments: ['skewX', 'skewY', 'cx', 'cy']\r\n  , method: 'skew'\r\n  }\r\n\r\n})\r\n\nSVG.extend(SVG.Element, {\r\n  // Dynamic style generator\r\n  style: function(s, v) {\r\n    if (arguments.length == 0) {\r\n      // get full style\r\n      return this.node.style.cssText || ''\r\n\r\n    } else if (arguments.length < 2) {\r\n      // apply every style individually if an object is passed\r\n      if (typeof s == 'object') {\r\n        for (v in s) this.style(v, s[v])\r\n\r\n      } else if (SVG.regex.isCss.test(s)) {\r\n        // parse css string\r\n        s = s.split(/\\s*;\\s*/)\r\n          // filter out suffix ; and stuff like ;;\r\n          .filter(function(e) { return !!e })\r\n          .map(function(e){ return e.split(/\\s*:\\s*/) })\r\n\r\n        // apply every definition individually\r\n        while (v = s.pop()) {\r\n          this.style(v[0], v[1])\r\n        }\r\n      } else {\r\n        // act as a getter if the first and only argument is not an object\r\n        return this.node.style[camelCase(s)]\r\n      }\r\n\r\n    } else {\r\n      this.node.style[camelCase(s)] = v === null || SVG.regex.isBlank.test(v) ? '' : v\r\n    }\r\n\r\n    return this\r\n  }\r\n})\nSVG.Parent = SVG.invent({\r\n  // Initialize node\r\n  create: function(element) {\r\n    this.constructor.call(this, element)\r\n  }\r\n\r\n  // Inherit from\r\n, inherit: SVG.Element\r\n\r\n  // Add class methods\r\n, extend: {\r\n    // Returns all child elements\r\n    children: function() {\r\n      return SVG.utils.map(SVG.utils.filterSVGElements(this.node.childNodes), function(node) {\r\n        return SVG.adopt(node)\r\n      })\r\n    }\r\n    // Add given element at a position\r\n  , add: function(element, i) {\r\n      if (i == null)\r\n        this.node.appendChild(element.node)\r\n      else if (element.node != this.node.childNodes[i])\r\n        this.node.insertBefore(element.node, this.node.childNodes[i])\r\n\r\n      return this\r\n    }\r\n    // Basically does the same as `add()` but returns the added element instead\r\n  , put: function(element, i) {\r\n      this.add(element, i)\r\n      return element\r\n    }\r\n    // Checks if the given element is a child\r\n  , has: function(element) {\r\n      return this.index(element) >= 0\r\n    }\r\n    // Gets index of given element\r\n  , index: function(element) {\r\n      return [].slice.call(this.node.childNodes).indexOf(element.node)\r\n    }\r\n    // Get a element at the given index\r\n  , get: function(i) {\r\n      return SVG.adopt(this.node.childNodes[i])\r\n    }\r\n    // Get first child\r\n  , first: function() {\r\n      return this.get(0)\r\n    }\r\n    // Get the last child\r\n  , last: function() {\r\n      return this.get(this.node.childNodes.length - 1)\r\n    }\r\n    // Iterates over all children and invokes a given block\r\n  , each: function(block, deep) {\r\n      var i, il\r\n        , children = this.children()\r\n\r\n      for (i = 0, il = children.length; i < il; i++) {\r\n        if (children[i] instanceof SVG.Element)\r\n          block.apply(children[i], [i, children])\r\n\r\n        if (deep && (children[i] instanceof SVG.Container))\r\n          children[i].each(block, deep)\r\n      }\r\n\r\n      return this\r\n    }\r\n    // Remove a given child\r\n  , removeElement: function(element) {\r\n      this.node.removeChild(element.node)\r\n\r\n      return this\r\n    }\r\n    // Remove all elements in this container\r\n  , clear: function() {\r\n      // remove children\r\n      while(this.node.hasChildNodes())\r\n        this.node.removeChild(this.node.lastChild)\r\n\r\n      // remove defs reference\r\n      delete this._defs\r\n\r\n      return this\r\n    }\r\n  , // Get defs\r\n    defs: function() {\r\n      return this.doc().defs()\r\n    }\r\n  }\r\n\r\n})\r\n\nSVG.extend(SVG.Parent, {\r\n\r\n  ungroup: function(parent, depth) {\r\n    if(depth === 0 || this instanceof SVG.Defs || this.node == SVG.parser.draw) return this\r\n\r\n    parent = parent || (this instanceof SVG.Doc ? this : this.parent(SVG.Parent))\r\n    depth = depth || Infinity\r\n\r\n    this.each(function(){\r\n      if(this instanceof SVG.Defs) return this\r\n      if(this instanceof SVG.Parent) return this.ungroup(parent, depth-1)\r\n      return this.toParent(parent)\r\n    })\r\n\r\n    this.node.firstChild || this.remove()\r\n\r\n    return this\r\n  },\r\n\r\n  flatten: function(parent, depth) {\r\n    return this.ungroup(parent, depth)\r\n  }\r\n\r\n})\nSVG.Container = SVG.invent({\r\n  // Initialize node\r\n  create: function(element) {\r\n    this.constructor.call(this, element)\r\n  }\r\n\r\n  // Inherit from\r\n, inherit: SVG.Parent\r\n\r\n})\n\r\nSVG.ViewBox = SVG.invent({\r\n\r\n  create: function(source) {\r\n    var i, base = [0, 0, 0, 0]\r\n\r\n    var x, y, width, height, box, view, we, he\r\n      , wm   = 1 // width multiplier\r\n      , hm   = 1 // height multiplier\r\n      , reg  = /[+-]?(?:\\d+(?:\\.\\d*)?|\\.\\d+)(?:e[+-]?\\d+)?/gi\r\n\r\n    if(source instanceof SVG.Element){\r\n\r\n      we = source\r\n      he = source\r\n      view = (source.attr('viewBox') || '').match(reg)\r\n      box = source.bbox\r\n\r\n      // get dimensions of current node\r\n      width  = new SVG.Number(source.width())\r\n      height = new SVG.Number(source.height())\r\n\r\n      // find nearest non-percentual dimensions\r\n      while (width.unit == '%') {\r\n        wm *= width.value\r\n        width = new SVG.Number(we instanceof SVG.Doc ? we.parent().offsetWidth : we.parent().width())\r\n        we = we.parent()\r\n      }\r\n      while (height.unit == '%') {\r\n        hm *= height.value\r\n        height = new SVG.Number(he instanceof SVG.Doc ? he.parent().offsetHeight : he.parent().height())\r\n        he = he.parent()\r\n      }\r\n\r\n      // ensure defaults\r\n      this.x      = 0\r\n      this.y      = 0\r\n      this.width  = width  * wm\r\n      this.height = height * hm\r\n      this.zoom   = 1\r\n\r\n      if (view) {\r\n        // get width and height from viewbox\r\n        x      = parseFloat(view[0])\r\n        y      = parseFloat(view[1])\r\n        width  = parseFloat(view[2])\r\n        height = parseFloat(view[3])\r\n\r\n        // calculate zoom accoring to viewbox\r\n        this.zoom = ((this.width / this.height) > (width / height)) ?\r\n          this.height / height :\r\n          this.width  / width\r\n\r\n        // calculate real pixel dimensions on parent SVG.Doc element\r\n        this.x      = x\r\n        this.y      = y\r\n        this.width  = width\r\n        this.height = height\r\n\r\n      }\r\n\r\n    }else{\r\n\r\n      // ensure source as object\r\n      source = typeof source === 'string' ?\r\n        source.match(reg).map(function(el){ return parseFloat(el) }) :\r\n      Array.isArray(source) ?\r\n        source :\r\n      typeof source == 'object' ?\r\n        [source.x, source.y, source.width, source.height] :\r\n      arguments.length == 4 ?\r\n        [].slice.call(arguments) :\r\n        base\r\n\r\n      this.x = source[0]\r\n      this.y = source[1]\r\n      this.width = source[2]\r\n      this.height = source[3]\r\n    }\r\n\r\n\r\n  }\r\n\r\n, extend: {\r\n\r\n    toString: function() {\r\n      return this.x + ' ' + this.y + ' ' + this.width + ' ' + this.height\r\n    }\r\n  , morph: function(x, y, width, height){\r\n      this.destination = new SVG.ViewBox(x, y, width, height)\r\n      return this\r\n    }\r\n\r\n  , at: function(pos) {\r\n\r\n      if(!this.destination) return this\r\n\r\n      return new SVG.ViewBox([\r\n          this.x + (this.destination.x - this.x) * pos\r\n        , this.y + (this.destination.y - this.y) * pos\r\n        , this.width + (this.destination.width - this.width) * pos\r\n        , this.height + (this.destination.height - this.height) * pos\r\n      ])\r\n\r\n    }\r\n\r\n  }\r\n\r\n  // Define parent\r\n, parent: SVG.Container\r\n\r\n  // Add parent method\r\n, construct: {\r\n\r\n    // get/set viewbox\r\n    viewbox: function(x, y, width, height) {\r\n      if (arguments.length == 0)\r\n        // act as a getter if there are no arguments\r\n        return new SVG.ViewBox(this)\r\n\r\n      // otherwise act as a setter\r\n      return this.attr('viewBox', new SVG.ViewBox(x, y, width, height))\r\n    }\r\n\r\n  }\r\n\r\n})\n// Add events to elements\r\n;[  'click'\r\n  , 'dblclick'\r\n  , 'mousedown'\r\n  , 'mouseup'\r\n  , 'mouseover'\r\n  , 'mouseout'\r\n  , 'mousemove'\r\n  // , 'mouseenter' -> not supported by IE\r\n  // , 'mouseleave' -> not supported by IE\r\n  , 'touchstart'\r\n  , 'touchmove'\r\n  , 'touchleave'\r\n  , 'touchend'\r\n  , 'touchcancel' ].forEach(function(event) {\r\n\r\n  // add event to SVG.Element\r\n  SVG.Element.prototype[event] = function(f) {\r\n    // bind event to element rather than element node\r\n    SVG.on(this.node, event, f)\r\n    return this\r\n  }\r\n})\r\n\r\n// Initialize listeners stack\r\nSVG.listeners = []\r\nSVG.handlerMap = []\r\nSVG.listenerId = 0\r\n\r\n// Add event binder in the SVG namespace\r\nSVG.on = function(node, event, listener, binding, options) {\r\n  // create listener, get object-index\r\n  var l     = listener.bind(binding || node.instance || node)\r\n    , index = (SVG.handlerMap.indexOf(node) + 1 || SVG.handlerMap.push(node)) - 1\r\n    , ev    = event.split('.')[0]\r\n    , ns    = event.split('.')[1] || '*'\r\n\r\n\r\n  // ensure valid object\r\n  SVG.listeners[index]         = SVG.listeners[index]         || {}\r\n  SVG.listeners[index][ev]     = SVG.listeners[index][ev]     || {}\r\n  SVG.listeners[index][ev][ns] = SVG.listeners[index][ev][ns] || {}\r\n\r\n  if(!listener._svgjsListenerId)\r\n    listener._svgjsListenerId = ++SVG.listenerId\r\n\r\n  // reference listener\r\n  SVG.listeners[index][ev][ns][listener._svgjsListenerId] = l\r\n\r\n  // add listener\r\n  node.addEventListener(ev, l, options || false)\r\n}\r\n\r\n// Add event unbinder in the SVG namespace\r\nSVG.off = function(node, event, listener) {\r\n  var index = SVG.handlerMap.indexOf(node)\r\n    , ev    = event && event.split('.')[0]\r\n    , ns    = event && event.split('.')[1]\r\n    , namespace = ''\r\n\r\n  if(index == -1) return\r\n\r\n  if (listener) {\r\n    if(typeof listener == 'function') listener = listener._svgjsListenerId\r\n    if(!listener) return\r\n\r\n    // remove listener reference\r\n    if (SVG.listeners[index][ev] && SVG.listeners[index][ev][ns || '*']) {\r\n      // remove listener\r\n      node.removeEventListener(ev, SVG.listeners[index][ev][ns || '*'][listener], false)\r\n\r\n      delete SVG.listeners[index][ev][ns || '*'][listener]\r\n    }\r\n\r\n  } else if (ns && ev) {\r\n    // remove all listeners for a namespaced event\r\n    if (SVG.listeners[index][ev] && SVG.listeners[index][ev][ns]) {\r\n      for (listener in SVG.listeners[index][ev][ns])\r\n        SVG.off(node, [ev, ns].join('.'), listener)\r\n\r\n      delete SVG.listeners[index][ev][ns]\r\n    }\r\n\r\n  } else if (ns){\r\n    // remove all listeners for a specific namespace\r\n    for(event in SVG.listeners[index]){\r\n        for(namespace in SVG.listeners[index][event]){\r\n            if(ns === namespace){\r\n                SVG.off(node, [event, ns].join('.'))\r\n            }\r\n        }\r\n    }\r\n\r\n  } else if (ev) {\r\n    // remove all listeners for the event\r\n    if (SVG.listeners[index][ev]) {\r\n      for (namespace in SVG.listeners[index][ev])\r\n        SVG.off(node, [ev, namespace].join('.'))\r\n\r\n      delete SVG.listeners[index][ev]\r\n    }\r\n\r\n  } else {\r\n    // remove all listeners on a given node\r\n    for (event in SVG.listeners[index])\r\n      SVG.off(node, event)\r\n\r\n    delete SVG.listeners[index]\r\n    delete SVG.handlerMap[index]\r\n\r\n  }\r\n}\r\n\r\n//\r\nSVG.extend(SVG.Element, {\r\n  // Bind given event to listener\r\n  on: function(event, listener, binding, options) {\r\n    SVG.on(this.node, event, listener, binding, options)\r\n\r\n    return this\r\n  }\r\n  // Unbind event from listener\r\n, off: function(event, listener) {\r\n    SVG.off(this.node, event, listener)\r\n\r\n    return this\r\n  }\r\n  // Fire given event\r\n, fire: function(event, data) {\r\n\r\n    // Dispatch event\r\n    if(event instanceof window.Event){\r\n        this.node.dispatchEvent(event)\r\n    }else{\r\n        this.node.dispatchEvent(event = new window.CustomEvent(event, {detail:data, cancelable: true}))\r\n    }\r\n\r\n    this._event = event\r\n    return this\r\n  }\r\n, event: function() {\r\n    return this._event\r\n  }\r\n})\r\n\n\r\nSVG.Defs = SVG.invent({\r\n  // Initialize node\r\n  create: 'defs'\r\n\r\n  // Inherit from\r\n, inherit: SVG.Container\r\n\r\n})\nSVG.G = SVG.invent({\r\n  // Initialize node\r\n  create: 'g'\r\n\r\n  // Inherit from\r\n, inherit: SVG.Container\r\n\r\n  // Add class methods\r\n, extend: {\r\n    // Move over x-axis\r\n    x: function(x) {\r\n      return x == null ? this.transform('x') : this.transform({ x: x - this.x() }, true)\r\n    }\r\n    // Move over y-axis\r\n  , y: function(y) {\r\n      return y == null ? this.transform('y') : this.transform({ y: y - this.y() }, true)\r\n    }\r\n    // Move by center over x-axis\r\n  , cx: function(x) {\r\n      return x == null ? this.gbox().cx : this.x(x - this.gbox().width / 2)\r\n    }\r\n    // Move by center over y-axis\r\n  , cy: function(y) {\r\n      return y == null ? this.gbox().cy : this.y(y - this.gbox().height / 2)\r\n    }\r\n  , gbox: function() {\r\n\r\n      var bbox  = this.bbox()\r\n        , trans = this.transform()\r\n\r\n      bbox.x  += trans.x\r\n      bbox.x2 += trans.x\r\n      bbox.cx += trans.x\r\n\r\n      bbox.y  += trans.y\r\n      bbox.y2 += trans.y\r\n      bbox.cy += trans.y\r\n\r\n      return bbox\r\n    }\r\n  }\r\n\r\n  // Add parent method\r\n, construct: {\r\n    // Create a group element\r\n    group: function() {\r\n      return this.put(new SVG.G)\r\n    }\r\n  }\r\n})\r\n\n// ### This module adds backward / forward functionality to elements.\r\n\r\n//\r\nSVG.extend(SVG.Element, {\r\n  // Get all siblings, including myself\r\n  siblings: function() {\r\n    return this.parent().children()\r\n  }\r\n  // Get the curent position siblings\r\n, position: function() {\r\n    return this.parent().index(this)\r\n  }\r\n  // Get the next element (will return null if there is none)\r\n, next: function() {\r\n    return this.siblings()[this.position() + 1]\r\n  }\r\n  // Get the next element (will return null if there is none)\r\n, previous: function() {\r\n    return this.siblings()[this.position() - 1]\r\n  }\r\n  // Send given element one step forward\r\n, forward: function() {\r\n    var i = this.position() + 1\r\n      , p = this.parent()\r\n\r\n    // move node one step forward\r\n    p.removeElement(this).add(this, i)\r\n\r\n    // make sure defs node is always at the top\r\n    if (p instanceof SVG.Doc)\r\n      p.node.appendChild(p.defs().node)\r\n\r\n    return this\r\n  }\r\n  // Send given element one step backward\r\n, backward: function() {\r\n    var i = this.position()\r\n\r\n    if (i > 0)\r\n      this.parent().removeElement(this).add(this, i - 1)\r\n\r\n    return this\r\n  }\r\n  // Send given element all the way to the front\r\n, front: function() {\r\n    var p = this.parent()\r\n\r\n    // Move node forward\r\n    p.node.appendChild(this.node)\r\n\r\n    // Make sure defs node is always at the top\r\n    if (p instanceof SVG.Doc)\r\n      p.node.appendChild(p.defs().node)\r\n\r\n    return this\r\n  }\r\n  // Send given element all the way to the back\r\n, back: function() {\r\n    if (this.position() > 0)\r\n      this.parent().removeElement(this).add(this, 0)\r\n\r\n    return this\r\n  }\r\n  // Inserts a given element before the targeted element\r\n, before: function(element) {\r\n    element.remove()\r\n\r\n    var i = this.position()\r\n\r\n    this.parent().add(element, i)\r\n\r\n    return this\r\n  }\r\n  // Insters a given element after the targeted element\r\n, after: function(element) {\r\n    element.remove()\r\n\r\n    var i = this.position()\r\n\r\n    this.parent().add(element, i + 1)\r\n\r\n    return this\r\n  }\r\n\r\n})\nSVG.Mask = SVG.invent({\r\n  // Initialize node\r\n  create: function() {\r\n    this.constructor.call(this, SVG.create('mask'))\r\n\r\n    // keep references to masked elements\r\n    this.targets = []\r\n  }\r\n\r\n  // Inherit from\r\n, inherit: SVG.Container\r\n\r\n  // Add class methods\r\n, extend: {\r\n    // Unmask all masked elements and remove itself\r\n    remove: function() {\r\n      // unmask all targets\r\n      for (var i = this.targets.length - 1; i >= 0; i--)\r\n        if (this.targets[i])\r\n          this.targets[i].unmask()\r\n      this.targets = []\r\n\r\n      // remove mask from parent\r\n      this.parent().removeElement(this)\r\n\r\n      return this\r\n    }\r\n  }\r\n\r\n  // Add parent method\r\n, construct: {\r\n    // Create masking element\r\n    mask: function() {\r\n      return this.defs().put(new SVG.Mask)\r\n    }\r\n  }\r\n})\r\n\r\n\r\nSVG.extend(SVG.Element, {\r\n  // Distribute mask to svg element\r\n  maskWith: function(element) {\r\n    // use given mask or create a new one\r\n    this.masker = element instanceof SVG.Mask ? element : this.parent().mask().add(element)\r\n\r\n    // store reverence on self in mask\r\n    this.masker.targets.push(this)\r\n\r\n    // apply mask\r\n    return this.attr('mask', 'url(\"#' + this.masker.attr('id') + '\")')\r\n  }\r\n  // Unmask element\r\n, unmask: function() {\r\n    delete this.masker\r\n    return this.attr('mask', null)\r\n  }\r\n\r\n})\r\n\nSVG.ClipPath = SVG.invent({\r\n  // Initialize node\r\n  create: function() {\r\n    this.constructor.call(this, SVG.create('clipPath'))\r\n\r\n    // keep references to clipped elements\r\n    this.targets = []\r\n  }\r\n\r\n  // Inherit from\r\n, inherit: SVG.Container\r\n\r\n  // Add class methods\r\n, extend: {\r\n    // Unclip all clipped elements and remove itself\r\n    remove: function() {\r\n      // unclip all targets\r\n      for (var i = this.targets.length - 1; i >= 0; i--)\r\n        if (this.targets[i])\r\n          this.targets[i].unclip()\r\n      this.targets = []\r\n\r\n      // remove clipPath from parent\r\n      this.parent().removeElement(this)\r\n\r\n      return this\r\n    }\r\n  }\r\n\r\n  // Add parent method\r\n, construct: {\r\n    // Create clipping element\r\n    clip: function() {\r\n      return this.defs().put(new SVG.ClipPath)\r\n    }\r\n  }\r\n})\r\n\r\n//\r\nSVG.extend(SVG.Element, {\r\n  // Distribute clipPath to svg element\r\n  clipWith: function(element) {\r\n    // use given clip or create a new one\r\n    this.clipper = element instanceof SVG.ClipPath ? element : this.parent().clip().add(element)\r\n\r\n    // store reverence on self in mask\r\n    this.clipper.targets.push(this)\r\n\r\n    // apply mask\r\n    return this.attr('clip-path', 'url(\"#' + this.clipper.attr('id') + '\")')\r\n  }\r\n  // Unclip element\r\n, unclip: function() {\r\n    delete this.clipper\r\n    return this.attr('clip-path', null)\r\n  }\r\n\r\n})\nSVG.Gradient = SVG.invent({\r\n  // Initialize node\r\n  create: function(type) {\r\n    this.constructor.call(this, SVG.create(type + 'Gradient'))\r\n\r\n    // store type\r\n    this.type = type\r\n  }\r\n\r\n  // Inherit from\r\n, inherit: SVG.Container\r\n\r\n  // Add class methods\r\n, extend: {\r\n    // Add a color stop\r\n    at: function(offset, color, opacity) {\r\n      return this.put(new SVG.Stop).update(offset, color, opacity)\r\n    }\r\n    // Update gradient\r\n  , update: function(block) {\r\n      // remove all stops\r\n      this.clear()\r\n\r\n      // invoke passed block\r\n      if (typeof block == 'function')\r\n        block.call(this, this)\r\n\r\n      return this\r\n    }\r\n    // Return the fill id\r\n  , fill: function() {\r\n      return 'url(#' + this.id() + ')'\r\n    }\r\n    // Alias string convertion to fill\r\n  , toString: function() {\r\n      return this.fill()\r\n    }\r\n    // custom attr to handle transform\r\n  , attr: function(a, b, c) {\r\n      if(a == 'transform') a = 'gradientTransform'\r\n      return SVG.Container.prototype.attr.call(this, a, b, c)\r\n    }\r\n  }\r\n\r\n  // Add parent method\r\n, construct: {\r\n    // Create gradient element in defs\r\n    gradient: function(type, block) {\r\n      return this.defs().gradient(type, block)\r\n    }\r\n  }\r\n})\r\n\r\n// Add animatable methods to both gradient and fx module\r\nSVG.extend(SVG.Gradient, SVG.FX, {\r\n  // From position\r\n  from: function(x, y) {\r\n    return (this._target || this).type == 'radial' ?\r\n      this.attr({ fx: new SVG.Number(x), fy: new SVG.Number(y) }) :\r\n      this.attr({ x1: new SVG.Number(x), y1: new SVG.Number(y) })\r\n  }\r\n  // To position\r\n, to: function(x, y) {\r\n    return (this._target || this).type == 'radial' ?\r\n      this.attr({ cx: new SVG.Number(x), cy: new SVG.Number(y) }) :\r\n      this.attr({ x2: new SVG.Number(x), y2: new SVG.Number(y) })\r\n  }\r\n})\r\n\r\n// Base gradient generation\r\nSVG.extend(SVG.Defs, {\r\n  // define gradient\r\n  gradient: function(type, block) {\r\n    return this.put(new SVG.Gradient(type)).update(block)\r\n  }\r\n\r\n})\r\n\r\nSVG.Stop = SVG.invent({\r\n  // Initialize node\r\n  create: 'stop'\r\n\r\n  // Inherit from\r\n, inherit: SVG.Element\r\n\r\n  // Add class methods\r\n, extend: {\r\n    // add color stops\r\n    update: function(o) {\r\n      if (typeof o == 'number' || o instanceof SVG.Number) {\r\n        o = {\r\n          offset:  arguments[0]\r\n        , color:   arguments[1]\r\n        , opacity: arguments[2]\r\n        }\r\n      }\r\n\r\n      // set attributes\r\n      if (o.opacity != null) this.attr('stop-opacity', o.opacity)\r\n      if (o.color   != null) this.attr('stop-color', o.color)\r\n      if (o.offset  != null) this.attr('offset', new SVG.Number(o.offset))\r\n\r\n      return this\r\n    }\r\n  }\r\n\r\n})\r\n\nSVG.Pattern = SVG.invent({\r\n  // Initialize node\r\n  create: 'pattern'\r\n\r\n  // Inherit from\r\n, inherit: SVG.Container\r\n\r\n  // Add class methods\r\n, extend: {\r\n    // Return the fill id\r\n    fill: function() {\r\n      return 'url(#' + this.id() + ')'\r\n    }\r\n    // Update pattern by rebuilding\r\n  , update: function(block) {\r\n      // remove content\r\n      this.clear()\r\n\r\n      // invoke passed block\r\n      if (typeof block == 'function')\r\n        block.call(this, this)\r\n\r\n      return this\r\n    }\r\n    // Alias string convertion to fill\r\n  , toString: function() {\r\n      return this.fill()\r\n    }\r\n    // custom attr to handle transform\r\n  , attr: function(a, b, c) {\r\n      if(a == 'transform') a = 'patternTransform'\r\n      return SVG.Container.prototype.attr.call(this, a, b, c)\r\n    }\r\n\r\n  }\r\n\r\n  // Add parent method\r\n, construct: {\r\n    // Create pattern element in defs\r\n    pattern: function(width, height, block) {\r\n      return this.defs().pattern(width, height, block)\r\n    }\r\n  }\r\n})\r\n\r\nSVG.extend(SVG.Defs, {\r\n  // Define gradient\r\n  pattern: function(width, height, block) {\r\n    return this.put(new SVG.Pattern).update(block).attr({\r\n      x:            0\r\n    , y:            0\r\n    , width:        width\r\n    , height:       height\r\n    , patternUnits: 'userSpaceOnUse'\r\n    })\r\n  }\r\n\r\n})\nSVG.Doc = SVG.invent({\r\n  // Initialize node\r\n  create: function(element) {\r\n    if (element) {\r\n      // ensure the presence of a dom element\r\n      element = typeof element == 'string' ?\r\n        document.getElementById(element) :\r\n        element\r\n\r\n      // If the target is an svg element, use that element as the main wrapper.\r\n      // This allows svg.js to work with svg documents as well.\r\n      if (element.nodeName == 'svg') {\r\n        this.constructor.call(this, element)\r\n      } else {\r\n        this.constructor.call(this, SVG.create('svg'))\r\n        element.appendChild(this.node)\r\n        this.size('100%', '100%')\r\n      }\r\n\r\n      // set svg element attributes and ensure defs node\r\n      this.namespace().defs()\r\n    }\r\n  }\r\n\r\n  // Inherit from\r\n, inherit: SVG.Container\r\n\r\n  // Add class methods\r\n, extend: {\r\n    // Add namespaces\r\n    namespace: function() {\r\n      return this\r\n        .attr({ xmlns: SVG.ns, version: '1.1' })\r\n        .attr('xmlns:xlink', SVG.xlink, SVG.xmlns)\r\n        .attr('xmlns:svgjs', SVG.svgjs, SVG.xmlns)\r\n    }\r\n    // Creates and returns defs element\r\n  , defs: function() {\r\n      if (!this._defs) {\r\n        var defs\r\n\r\n        // Find or create a defs element in this instance\r\n        if (defs = this.node.getElementsByTagName('defs')[0])\r\n          this._defs = SVG.adopt(defs)\r\n        else\r\n          this._defs = new SVG.Defs\r\n\r\n        // Make sure the defs node is at the end of the stack\r\n        this.node.appendChild(this._defs.node)\r\n      }\r\n\r\n      return this._defs\r\n    }\r\n    // custom parent method\r\n  , parent: function() {\r\n      return this.node.parentNode.nodeName == '#document' ? null : this.node.parentNode\r\n    }\r\n    // Fix for possible sub-pixel offset. See:\r\n    // https://bugzilla.mozilla.org/show_bug.cgi?id=608812\r\n  , spof: function() {\r\n      var pos = this.node.getScreenCTM()\r\n\r\n      if (pos)\r\n        this\r\n          .style('left', (-pos.e % 1) + 'px')\r\n          .style('top',  (-pos.f % 1) + 'px')\r\n\r\n      return this\r\n    }\r\n\r\n      // Removes the doc from the DOM\r\n  , remove: function() {\r\n      if(this.parent()) {\r\n        this.parent().removeChild(this.node)\r\n      }\r\n\r\n      return this\r\n    }\r\n  , clear: function() {\r\n      // remove children\r\n      while(this.node.hasChildNodes())\r\n        this.node.removeChild(this.node.lastChild)\r\n\r\n      // remove defs reference\r\n      delete this._defs\r\n\r\n      // add back parser\r\n      if(!SVG.parser.draw.parentNode)\r\n        this.node.appendChild(SVG.parser.draw)\r\n\r\n      return this\r\n    }\r\n  }\r\n\r\n})\r\n\nSVG.Shape = SVG.invent({\r\n  // Initialize node\r\n  create: function(element) {\r\n    this.constructor.call(this, element)\r\n  }\r\n\r\n  // Inherit from\r\n, inherit: SVG.Element\r\n\r\n})\n\r\nSVG.Bare = SVG.invent({\r\n  // Initialize\r\n  create: function(element, inherit) {\r\n    // construct element\r\n    this.constructor.call(this, SVG.create(element))\r\n\r\n    // inherit custom methods\r\n    if (inherit)\r\n      for (var method in inherit.prototype)\r\n        if (typeof inherit.prototype[method] === 'function')\r\n          this[method] = inherit.prototype[method]\r\n  }\r\n\r\n  // Inherit from\r\n, inherit: SVG.Element\r\n\r\n  // Add methods\r\n, extend: {\r\n    // Insert some plain text\r\n    words: function(text) {\r\n      // remove contents\r\n      while (this.node.hasChildNodes())\r\n        this.node.removeChild(this.node.lastChild)\r\n\r\n      // create text node\r\n      this.node.appendChild(document.createTextNode(text))\r\n\r\n      return this\r\n    }\r\n  }\r\n})\r\n\r\n\r\nSVG.extend(SVG.Parent, {\r\n  // Create an element that is not described by SVG.js\r\n  element: function(element, inherit) {\r\n    return this.put(new SVG.Bare(element, inherit))\r\n  }\r\n})\r\n\nSVG.Symbol = SVG.invent({\r\n  // Initialize node\r\n  create: 'symbol'\r\n\r\n  // Inherit from\r\n, inherit: SVG.Container\r\n\r\n, construct: {\r\n    // create symbol\r\n    symbol: function() {\r\n      return this.put(new SVG.Symbol)\r\n    }\r\n  }\r\n})\r\n\nSVG.Use = SVG.invent({\r\n  // Initialize node\r\n  create: 'use'\r\n\r\n  // Inherit from\r\n, inherit: SVG.Shape\r\n\r\n  // Add class methods\r\n, extend: {\r\n    // Use element as a reference\r\n    element: function(element, file) {\r\n      // Set lined element\r\n      return this.attr('href', (file || '') + '#' + element, SVG.xlink)\r\n    }\r\n  }\r\n\r\n  // Add parent method\r\n, construct: {\r\n    // Create a use element\r\n    use: function(element, file) {\r\n      return this.put(new SVG.Use).element(element, file)\r\n    }\r\n  }\r\n})\nSVG.Rect = SVG.invent({\r\n  // Initialize node\r\n  create: 'rect'\r\n\r\n  // Inherit from\r\n, inherit: SVG.Shape\r\n\r\n  // Add parent method\r\n, construct: {\r\n    // Create a rect element\r\n    rect: function(width, height) {\r\n      return this.put(new SVG.Rect()).size(width, height)\r\n    }\r\n  }\r\n})\nSVG.Circle = SVG.invent({\r\n  // Initialize node\r\n  create: 'circle'\r\n\r\n  // Inherit from\r\n, inherit: SVG.Shape\r\n\r\n  // Add parent method\r\n, construct: {\r\n    // Create circle element, based on ellipse\r\n    circle: function(size) {\r\n      return this.put(new SVG.Circle).rx(new SVG.Number(size).divide(2)).move(0, 0)\r\n    }\r\n  }\r\n})\r\n\r\nSVG.extend(SVG.Circle, SVG.FX, {\r\n  // Radius x value\r\n  rx: function(rx) {\r\n    return this.attr('r', rx)\r\n  }\r\n  // Alias radius x value\r\n, ry: function(ry) {\r\n    return this.rx(ry)\r\n  }\r\n})\r\n\r\nSVG.Ellipse = SVG.invent({\r\n  // Initialize node\r\n  create: 'ellipse'\r\n\r\n  // Inherit from\r\n, inherit: SVG.Shape\r\n\r\n  // Add parent method\r\n, construct: {\r\n    // Create an ellipse\r\n    ellipse: function(width, height) {\r\n      return this.put(new SVG.Ellipse).size(width, height).move(0, 0)\r\n    }\r\n  }\r\n})\r\n\r\nSVG.extend(SVG.Ellipse, SVG.Rect, SVG.FX, {\r\n  // Radius x value\r\n  rx: function(rx) {\r\n    return this.attr('rx', rx)\r\n  }\r\n  // Radius y value\r\n, ry: function(ry) {\r\n    return this.attr('ry', ry)\r\n  }\r\n})\r\n\r\n// Add common method\r\nSVG.extend(SVG.Circle, SVG.Ellipse, {\r\n    // Move over x-axis\r\n    x: function(x) {\r\n      return x == null ? this.cx() - this.rx() : this.cx(x + this.rx())\r\n    }\r\n    // Move over y-axis\r\n  , y: function(y) {\r\n      return y == null ? this.cy() - this.ry() : this.cy(y + this.ry())\r\n    }\r\n    // Move by center over x-axis\r\n  , cx: function(x) {\r\n      return x == null ? this.attr('cx') : this.attr('cx', x)\r\n    }\r\n    // Move by center over y-axis\r\n  , cy: function(y) {\r\n      return y == null ? this.attr('cy') : this.attr('cy', y)\r\n    }\r\n    // Set width of element\r\n  , width: function(width) {\r\n      return width == null ? this.rx() * 2 : this.rx(new SVG.Number(width).divide(2))\r\n    }\r\n    // Set height of element\r\n  , height: function(height) {\r\n      return height == null ? this.ry() * 2 : this.ry(new SVG.Number(height).divide(2))\r\n    }\r\n    // Custom size function\r\n  , size: function(width, height) {\r\n      var p = proportionalSize(this, width, height)\r\n\r\n      return this\r\n        .rx(new SVG.Number(p.width).divide(2))\r\n        .ry(new SVG.Number(p.height).divide(2))\r\n    }\r\n})\nSVG.Line = SVG.invent({\r\n  // Initialize node\r\n  create: 'line'\r\n\r\n  // Inherit from\r\n, inherit: SVG.Shape\r\n\r\n  // Add class methods\r\n, extend: {\r\n    // Get array\r\n    array: function() {\r\n      return new SVG.PointArray([\r\n        [ this.attr('x1'), this.attr('y1') ]\r\n      , [ this.attr('x2'), this.attr('y2') ]\r\n      ])\r\n    }\r\n    // Overwrite native plot() method\r\n  , plot: function(x1, y1, x2, y2) {\r\n      if (x1 == null)\r\n        return this.array()\r\n      else if (typeof y1 !== 'undefined')\r\n        x1 = { x1: x1, y1: y1, x2: x2, y2: y2 }\r\n      else\r\n        x1 = new SVG.PointArray(x1).toLine()\r\n\r\n      return this.attr(x1)\r\n    }\r\n    // Move by left top corner\r\n  , move: function(x, y) {\r\n      return this.attr(this.array().move(x, y).toLine())\r\n    }\r\n    // Set element size to given width and height\r\n  , size: function(width, height) {\r\n      var p = proportionalSize(this, width, height)\r\n\r\n      return this.attr(this.array().size(p.width, p.height).toLine())\r\n    }\r\n  }\r\n\r\n  // Add parent method\r\n, construct: {\r\n    // Create a line element\r\n    line: function(x1, y1, x2, y2) {\r\n      // make sure plot is called as a setter\r\n      // x1 is not necessarily a number, it can also be an array, a string and a SVG.PointArray\r\n      return SVG.Line.prototype.plot.apply(\r\n        this.put(new SVG.Line)\r\n      , x1 != null ? [x1, y1, x2, y2] : [0, 0, 0, 0]\r\n      )\r\n    }\r\n  }\r\n})\r\n\nSVG.Polyline = SVG.invent({\r\n  // Initialize node\r\n  create: 'polyline'\r\n\r\n  // Inherit from\r\n, inherit: SVG.Shape\r\n\r\n  // Add parent method\r\n, construct: {\r\n    // Create a wrapped polyline element\r\n    polyline: function(p) {\r\n      // make sure plot is called as a setter\r\n      return this.put(new SVG.Polyline).plot(p || new SVG.PointArray)\r\n    }\r\n  }\r\n})\r\n\r\nSVG.Polygon = SVG.invent({\r\n  // Initialize node\r\n  create: 'polygon'\r\n\r\n  // Inherit from\r\n, inherit: SVG.Shape\r\n\r\n  // Add parent method\r\n, construct: {\r\n    // Create a wrapped polygon element\r\n    polygon: function(p) {\r\n      // make sure plot is called as a setter\r\n      return this.put(new SVG.Polygon).plot(p || new SVG.PointArray)\r\n    }\r\n  }\r\n})\r\n\r\n// Add polygon-specific functions\r\nSVG.extend(SVG.Polyline, SVG.Polygon, {\r\n  // Get array\r\n  array: function() {\r\n    return this._array || (this._array = new SVG.PointArray(this.attr('points')))\r\n  }\r\n  // Plot new path\r\n, plot: function(p) {\r\n    return (p == null) ?\r\n      this.array() :\r\n      this.clear().attr('points', typeof p == 'string' ? p : (this._array = new SVG.PointArray(p)))\r\n  }\r\n  // Clear array cache\r\n, clear: function() {\r\n    delete this._array\r\n    return this\r\n  }\r\n  // Move by left top corner\r\n, move: function(x, y) {\r\n    return this.attr('points', this.array().move(x, y))\r\n  }\r\n  // Set element size to given width and height\r\n, size: function(width, height) {\r\n    var p = proportionalSize(this, width, height)\r\n\r\n    return this.attr('points', this.array().size(p.width, p.height))\r\n  }\r\n\r\n})\r\n\n// unify all point to point elements\r\nSVG.extend(SVG.Line, SVG.Polyline, SVG.Polygon, {\r\n  // Define morphable array\r\n  morphArray:  SVG.PointArray\r\n  // Move by left top corner over x-axis\r\n, x: function(x) {\r\n    return x == null ? this.bbox().x : this.move(x, this.bbox().y)\r\n  }\r\n  // Move by left top corner over y-axis\r\n, y: function(y) {\r\n    return y == null ? this.bbox().y : this.move(this.bbox().x, y)\r\n  }\r\n  // Set width of element\r\n, width: function(width) {\r\n    var b = this.bbox()\r\n\r\n    return width == null ? b.width : this.size(width, b.height)\r\n  }\r\n  // Set height of element\r\n, height: function(height) {\r\n    var b = this.bbox()\r\n\r\n    return height == null ? b.height : this.size(b.width, height)\r\n  }\r\n})\nSVG.Path = SVG.invent({\r\n  // Initialize node\r\n  create: 'path'\r\n\r\n  // Inherit from\r\n, inherit: SVG.Shape\r\n\r\n  // Add class methods\r\n, extend: {\r\n    // Define morphable array\r\n    morphArray:  SVG.PathArray\r\n    // Get array\r\n  , array: function() {\r\n      return this._array || (this._array = new SVG.PathArray(this.attr('d')))\r\n    }\r\n    // Plot new path\r\n  , plot: function(d) {\r\n      return (d == null) ?\r\n        this.array() :\r\n        this.clear().attr('d', typeof d == 'string' ? d : (this._array = new SVG.PathArray(d)))\r\n    }\r\n    // Clear array cache\r\n  , clear: function() {\r\n      delete this._array\r\n      return this\r\n    }\r\n    // Move by left top corner\r\n  , move: function(x, y) {\r\n      return this.attr('d', this.array().move(x, y))\r\n    }\r\n    // Move by left top corner over x-axis\r\n  , x: function(x) {\r\n      return x == null ? this.bbox().x : this.move(x, this.bbox().y)\r\n    }\r\n    // Move by left top corner over y-axis\r\n  , y: function(y) {\r\n      return y == null ? this.bbox().y : this.move(this.bbox().x, y)\r\n    }\r\n    // Set element size to given width and height\r\n  , size: function(width, height) {\r\n      var p = proportionalSize(this, width, height)\r\n\r\n      return this.attr('d', this.array().size(p.width, p.height))\r\n    }\r\n    // Set width of element\r\n  , width: function(width) {\r\n      return width == null ? this.bbox().width : this.size(width, this.bbox().height)\r\n    }\r\n    // Set height of element\r\n  , height: function(height) {\r\n      return height == null ? this.bbox().height : this.size(this.bbox().width, height)\r\n    }\r\n\r\n  }\r\n\r\n  // Add parent method\r\n, construct: {\r\n    // Create a wrapped path element\r\n    path: function(d) {\r\n      // make sure plot is called as a setter\r\n      return this.put(new SVG.Path).plot(d || new SVG.PathArray)\r\n    }\r\n  }\r\n})\r\n\nSVG.Image = SVG.invent({\r\n  // Initialize node\r\n  create: 'image'\r\n\r\n  // Inherit from\r\n, inherit: SVG.Shape\r\n\r\n  // Add class methods\r\n, extend: {\r\n    // (re)load image\r\n    load: function(url) {\r\n      if (!url) return this\r\n\r\n      var self = this\r\n        , img  = new window.Image()\r\n\r\n      // preload image\r\n      SVG.on(img, 'load', function() {\r\n        var p = self.parent(SVG.Pattern)\r\n\r\n        if(p === null) return\r\n\r\n        // ensure image size\r\n        if (self.width() == 0 && self.height() == 0)\r\n          self.size(img.width, img.height)\r\n\r\n        // ensure pattern size if not set\r\n        if (p && p.width() == 0 && p.height() == 0)\r\n          p.size(self.width(), self.height())\r\n\r\n        // callback\r\n        if (typeof self._loaded === 'function')\r\n          self._loaded.call(self, {\r\n            width:  img.width\r\n          , height: img.height\r\n          , ratio:  img.width / img.height\r\n          , url:    url\r\n          })\r\n      })\r\n\r\n      SVG.on(img, 'error', function(e){\r\n        if (typeof self._error === 'function'){\r\n            self._error.call(self, e)\r\n        }\r\n      })\r\n\r\n      return this.attr('href', (img.src = this.src = url), SVG.xlink)\r\n    }\r\n    // Add loaded callback\r\n  , loaded: function(loaded) {\r\n      this._loaded = loaded\r\n      return this\r\n    }\r\n\r\n  , error: function(error) {\r\n      this._error = error\r\n      return this\r\n    }\r\n  }\r\n\r\n  // Add parent method\r\n, construct: {\r\n    // create image element, load image and set its size\r\n    image: function(source, width, height) {\r\n      return this.put(new SVG.Image).load(source).size(width || 0, height || width || 0)\r\n    }\r\n  }\r\n\r\n})\nSVG.Text = SVG.invent({\r\n  // Initialize node\r\n  create: function() {\r\n    this.constructor.call(this, SVG.create('text'))\r\n\r\n    this.dom.leading = new SVG.Number(1.3)    // store leading value for rebuilding\r\n    this._rebuild = true                      // enable automatic updating of dy values\r\n    this._build   = false                     // disable build mode for adding multiple lines\r\n\r\n    // set default font\r\n    this.attr('font-family', SVG.defaults.attrs['font-family'])\r\n  }\r\n\r\n  // Inherit from\r\n, inherit: SVG.Shape\r\n\r\n  // Add class methods\r\n, extend: {\r\n    // Move over x-axis\r\n    x: function(x) {\r\n      // act as getter\r\n      if (x == null)\r\n        return this.attr('x')\r\n\r\n      return this.attr('x', x)\r\n    }\r\n    // Move over y-axis\r\n  , y: function(y) {\r\n      var oy = this.attr('y')\r\n        , o  = typeof oy === 'number' ? oy - this.bbox().y : 0\r\n\r\n      // act as getter\r\n      if (y == null)\r\n        return typeof oy === 'number' ? oy - o : oy\r\n\r\n      return this.attr('y', typeof y === 'number' ? y + o : y)\r\n    }\r\n    // Move center over x-axis\r\n  , cx: function(x) {\r\n      return x == null ? this.bbox().cx : this.x(x - this.bbox().width / 2)\r\n    }\r\n    // Move center over y-axis\r\n  , cy: function(y) {\r\n      return y == null ? this.bbox().cy : this.y(y - this.bbox().height / 2)\r\n    }\r\n    // Set the text content\r\n  , text: function(text) {\r\n      // act as getter\r\n      if (typeof text === 'undefined'){\r\n        var text = ''\r\n        var children = this.node.childNodes\r\n        for(var i = 0, len = children.length; i < len; ++i){\r\n\r\n          // add newline if its not the first child and newLined is set to true\r\n          if(i != 0 && children[i].nodeType != 3 && SVG.adopt(children[i]).dom.newLined == true){\r\n            text += '\\n'\r\n          }\r\n\r\n          // add content of this node\r\n          text += children[i].textContent\r\n        }\r\n\r\n        return text\r\n      }\r\n\r\n      // remove existing content\r\n      this.clear().build(true)\r\n\r\n      if (typeof text === 'function') {\r\n        // call block\r\n        text.call(this, this)\r\n\r\n      } else {\r\n        // store text and make sure text is not blank\r\n        text = text.split('\\n')\r\n\r\n        // build new lines\r\n        for (var i = 0, il = text.length; i < il; i++)\r\n          this.tspan(text[i]).newLine()\r\n      }\r\n\r\n      // disable build mode and rebuild lines\r\n      return this.build(false).rebuild()\r\n    }\r\n    // Set font size\r\n  , size: function(size) {\r\n      return this.attr('font-size', size).rebuild()\r\n    }\r\n    // Set / get leading\r\n  , leading: function(value) {\r\n      // act as getter\r\n      if (value == null)\r\n        return this.dom.leading\r\n\r\n      // act as setter\r\n      this.dom.leading = new SVG.Number(value)\r\n\r\n      return this.rebuild()\r\n    }\r\n    // Get all the first level lines\r\n  , lines: function() {\r\n      var node = (this.textPath && this.textPath() || this).node\r\n\r\n      // filter tspans and map them to SVG.js instances\r\n      var lines = SVG.utils.map(SVG.utils.filterSVGElements(node.childNodes), function(el){\r\n        return SVG.adopt(el)\r\n      })\r\n\r\n      // return an instance of SVG.set\r\n      return new SVG.Set(lines)\r\n    }\r\n    // Rebuild appearance type\r\n  , rebuild: function(rebuild) {\r\n      // store new rebuild flag if given\r\n      if (typeof rebuild == 'boolean')\r\n        this._rebuild = rebuild\r\n\r\n      // define position of all lines\r\n      if (this._rebuild) {\r\n        var self = this\r\n          , blankLineOffset = 0\r\n          , dy = this.dom.leading * new SVG.Number(this.attr('font-size'))\r\n\r\n        this.lines().each(function() {\r\n          if (this.dom.newLined) {\r\n            if (!self.textPath())\r\n              this.attr('x', self.attr('x'))\r\n            if(this.text() == '\\n') {\r\n              blankLineOffset += dy\r\n            }else{\r\n              this.attr('dy', dy + blankLineOffset)\r\n              blankLineOffset = 0\r\n            }\r\n          }\r\n        })\r\n\r\n        this.fire('rebuild')\r\n      }\r\n\r\n      return this\r\n    }\r\n    // Enable / disable build mode\r\n  , build: function(build) {\r\n      this._build = !!build\r\n      return this\r\n    }\r\n    // overwrite method from parent to set data properly\r\n  , setData: function(o){\r\n      this.dom = o\r\n      this.dom.leading = new SVG.Number(o.leading || 1.3)\r\n      return this\r\n    }\r\n  }\r\n\r\n  // Add parent method\r\n, construct: {\r\n    // Create text element\r\n    text: function(text) {\r\n      return this.put(new SVG.Text).text(text)\r\n    }\r\n    // Create plain text element\r\n  , plain: function(text) {\r\n      return this.put(new SVG.Text).plain(text)\r\n    }\r\n  }\r\n\r\n})\r\n\r\nSVG.Tspan = SVG.invent({\r\n  // Initialize node\r\n  create: 'tspan'\r\n\r\n  // Inherit from\r\n, inherit: SVG.Shape\r\n\r\n  // Add class methods\r\n, extend: {\r\n    // Set text content\r\n    text: function(text) {\r\n      if(text == null) return this.node.textContent + (this.dom.newLined ? '\\n' : '')\r\n\r\n      typeof text === 'function' ? text.call(this, this) : this.plain(text)\r\n\r\n      return this\r\n    }\r\n    // Shortcut dx\r\n  , dx: function(dx) {\r\n      return this.attr('dx', dx)\r\n    }\r\n    // Shortcut dy\r\n  , dy: function(dy) {\r\n      return this.attr('dy', dy)\r\n    }\r\n    // Create new line\r\n  , newLine: function() {\r\n      // fetch text parent\r\n      var t = this.parent(SVG.Text)\r\n\r\n      // mark new line\r\n      this.dom.newLined = true\r\n\r\n      // apply new hyn\r\n      return this.dy(t.dom.leading * t.attr('font-size')).attr('x', t.x())\r\n    }\r\n  }\r\n\r\n})\r\n\r\nSVG.extend(SVG.Text, SVG.Tspan, {\r\n  // Create plain text node\r\n  plain: function(text) {\r\n    // clear if build mode is disabled\r\n    if (this._build === false)\r\n      this.clear()\r\n\r\n    // create text node\r\n    this.node.appendChild(document.createTextNode(text))\r\n\r\n    return this\r\n  }\r\n  // Create a tspan\r\n, tspan: function(text) {\r\n    var node  = (this.textPath && this.textPath() || this).node\r\n      , tspan = new SVG.Tspan\r\n\r\n    // clear if build mode is disabled\r\n    if (this._build === false)\r\n      this.clear()\r\n\r\n    // add new tspan\r\n    node.appendChild(tspan.node)\r\n\r\n    return tspan.text(text)\r\n  }\r\n  // Clear all lines\r\n, clear: function() {\r\n    var node = (this.textPath && this.textPath() || this).node\r\n\r\n    // remove existing child nodes\r\n    while (node.hasChildNodes())\r\n      node.removeChild(node.lastChild)\r\n\r\n    return this\r\n  }\r\n  // Get length of text element\r\n, length: function() {\r\n    return this.node.getComputedTextLength()\r\n  }\r\n})\r\n\nSVG.TextPath = SVG.invent({\r\n  // Initialize node\r\n  create: 'textPath'\r\n\r\n  // Inherit from\r\n, inherit: SVG.Parent\r\n\r\n  // Define parent class\r\n, parent: SVG.Text\r\n\r\n  // Add parent method\r\n, construct: {\r\n    morphArray: SVG.PathArray\r\n    // Create path for text to run on\r\n  , path: function(d) {\r\n      // create textPath element\r\n      var path  = new SVG.TextPath\r\n        , track = this.doc().defs().path(d)\r\n\r\n      // move lines to textpath\r\n      while (this.node.hasChildNodes())\r\n        path.node.appendChild(this.node.firstChild)\r\n\r\n      // add textPath element as child node\r\n      this.node.appendChild(path.node)\r\n\r\n      // link textPath to path and add content\r\n      path.attr('href', '#' + track, SVG.xlink)\r\n\r\n      return this\r\n    }\r\n    // return the array of the path track element\r\n  , array: function() {\r\n      var track = this.track()\r\n\r\n      return track ? track.array() : null\r\n    }\r\n    // Plot path if any\r\n  , plot: function(d) {\r\n      var track = this.track()\r\n        , pathArray = null\r\n\r\n      if (track) {\r\n        pathArray = track.plot(d)\r\n      }\r\n\r\n      return (d == null) ? pathArray : this\r\n    }\r\n    // Get the path track element\r\n  , track: function() {\r\n      var path = this.textPath()\r\n\r\n      if (path)\r\n        return path.reference('href')\r\n    }\r\n    // Get the textPath child\r\n  , textPath: function() {\r\n      if (this.node.firstChild && this.node.firstChild.nodeName == 'textPath')\r\n        return SVG.adopt(this.node.firstChild)\r\n    }\r\n  }\r\n})\r\n\nSVG.Nested = SVG.invent({\r\n  // Initialize node\r\n  create: function() {\r\n    this.constructor.call(this, SVG.create('svg'))\r\n\r\n    this.style('overflow', 'visible')\r\n  }\r\n\r\n  // Inherit from\r\n, inherit: SVG.Container\r\n\r\n  // Add parent method\r\n, construct: {\r\n    // Create nested svg document\r\n    nested: function() {\r\n      return this.put(new SVG.Nested)\r\n    }\r\n  }\r\n})\nSVG.A = SVG.invent({\r\n  // Initialize node\r\n  create: 'a'\r\n\r\n  // Inherit from\r\n, inherit: SVG.Container\r\n\r\n  // Add class methods\r\n, extend: {\r\n    // Link url\r\n    to: function(url) {\r\n      return this.attr('href', url, SVG.xlink)\r\n    }\r\n    // Link show attribute\r\n  , show: function(target) {\r\n      return this.attr('show', target, SVG.xlink)\r\n    }\r\n    // Link target attribute\r\n  , target: function(target) {\r\n      return this.attr('target', target)\r\n    }\r\n  }\r\n\r\n  // Add parent method\r\n, construct: {\r\n    // Create a hyperlink element\r\n    link: function(url) {\r\n      return this.put(new SVG.A).to(url)\r\n    }\r\n  }\r\n})\r\n\r\nSVG.extend(SVG.Element, {\r\n  // Create a hyperlink element\r\n  linkTo: function(url) {\r\n    var link = new SVG.A\r\n\r\n    if (typeof url == 'function')\r\n      url.call(link, link)\r\n    else\r\n      link.to(url)\r\n\r\n    return this.parent().put(link).put(this)\r\n  }\r\n\r\n})\nSVG.Marker = SVG.invent({\r\n  // Initialize node\r\n  create: 'marker'\r\n\r\n  // Inherit from\r\n, inherit: SVG.Container\r\n\r\n  // Add class methods\r\n, extend: {\r\n    // Set width of element\r\n    width: function(width) {\r\n      return this.attr('markerWidth', width)\r\n    }\r\n    // Set height of element\r\n  , height: function(height) {\r\n      return this.attr('markerHeight', height)\r\n    }\r\n    // Set marker refX and refY\r\n  , ref: function(x, y) {\r\n      return this.attr('refX', x).attr('refY', y)\r\n    }\r\n    // Update marker\r\n  , update: function(block) {\r\n      // remove all content\r\n      this.clear()\r\n\r\n      // invoke passed block\r\n      if (typeof block == 'function')\r\n        block.call(this, this)\r\n\r\n      return this\r\n    }\r\n    // Return the fill id\r\n  , toString: function() {\r\n      return 'url(#' + this.id() + ')'\r\n    }\r\n  }\r\n\r\n  // Add parent method\r\n, construct: {\r\n    marker: function(width, height, block) {\r\n      // Create marker element in defs\r\n      return this.defs().marker(width, height, block)\r\n    }\r\n  }\r\n\r\n})\r\n\r\nSVG.extend(SVG.Defs, {\r\n  // Create marker\r\n  marker: function(width, height, block) {\r\n    // Set default viewbox to match the width and height, set ref to cx and cy and set orient to auto\r\n    return this.put(new SVG.Marker)\r\n      .size(width, height)\r\n      .ref(width / 2, height / 2)\r\n      .viewbox(0, 0, width, height)\r\n      .attr('orient', 'auto')\r\n      .update(block)\r\n  }\r\n\r\n})\r\n\r\nSVG.extend(SVG.Line, SVG.Polyline, SVG.Polygon, SVG.Path, {\r\n  // Create and attach markers\r\n  marker: function(marker, width, height, block) {\r\n    var attr = ['marker']\r\n\r\n    // Build attribute name\r\n    if (marker != 'all') attr.push(marker)\r\n    attr = attr.join('-')\r\n\r\n    // Set marker attribute\r\n    marker = arguments[1] instanceof SVG.Marker ?\r\n      arguments[1] :\r\n      this.doc().marker(width, height, block)\r\n\r\n    return this.attr(attr, marker)\r\n  }\r\n\r\n})\n// Define list of available attributes for stroke and fill\r\nvar sugar = {\r\n  stroke: ['color', 'width', 'opacity', 'linecap', 'linejoin', 'miterlimit', 'dasharray', 'dashoffset']\r\n, fill:   ['color', 'opacity', 'rule']\r\n, prefix: function(t, a) {\r\n    return a == 'color' ? t : t + '-' + a\r\n  }\r\n}\r\n\r\n// Add sugar for fill and stroke\r\n;['fill', 'stroke'].forEach(function(m) {\r\n  var i, extension = {}\r\n\r\n  extension[m] = function(o) {\r\n    if (typeof o == 'undefined')\r\n      return this\r\n    if (typeof o == 'string' || SVG.Color.isRgb(o) || (o && typeof o.fill === 'function'))\r\n      this.attr(m, o)\r\n\r\n    else\r\n      // set all attributes from sugar.fill and sugar.stroke list\r\n      for (i = sugar[m].length - 1; i >= 0; i--)\r\n        if (o[sugar[m][i]] != null)\r\n          this.attr(sugar.prefix(m, sugar[m][i]), o[sugar[m][i]])\r\n\r\n    return this\r\n  }\r\n\r\n  SVG.extend(SVG.Element, SVG.FX, extension)\r\n\r\n})\r\n\r\nSVG.extend(SVG.Element, SVG.FX, {\r\n  // Map rotation to transform\r\n  rotate: function(d, cx, cy) {\r\n    return this.transform({ rotation: d, cx: cx, cy: cy })\r\n  }\r\n  // Map skew to transform\r\n, skew: function(x, y, cx, cy) {\r\n    return arguments.length == 1  || arguments.length == 3 ?\r\n      this.transform({ skew: x, cx: y, cy: cx }) :\r\n      this.transform({ skewX: x, skewY: y, cx: cx, cy: cy })\r\n  }\r\n  // Map scale to transform\r\n, scale: function(x, y, cx, cy) {\r\n    return arguments.length == 1  || arguments.length == 3 ?\r\n      this.transform({ scale: x, cx: y, cy: cx }) :\r\n      this.transform({ scaleX: x, scaleY: y, cx: cx, cy: cy })\r\n  }\r\n  // Map translate to transform\r\n, translate: function(x, y) {\r\n    return this.transform({ x: x, y: y })\r\n  }\r\n  // Map flip to transform\r\n, flip: function(a, o) {\r\n    o = typeof a == 'number' ? a : o\r\n    return this.transform({ flip: a || 'both', offset: o })\r\n  }\r\n  // Map matrix to transform\r\n, matrix: function(m) {\r\n    return this.attr('transform', new SVG.Matrix(arguments.length == 6 ? [].slice.call(arguments) : m))\r\n  }\r\n  // Opacity\r\n, opacity: function(value) {\r\n    return this.attr('opacity', value)\r\n  }\r\n  // Relative move over x axis\r\n, dx: function(x) {\r\n    return this.x(new SVG.Number(x).plus(this instanceof SVG.FX ? 0 : this.x()), true)\r\n  }\r\n  // Relative move over y axis\r\n, dy: function(y) {\r\n    return this.y(new SVG.Number(y).plus(this instanceof SVG.FX ? 0 : this.y()), true)\r\n  }\r\n  // Relative move over x and y axes\r\n, dmove: function(x, y) {\r\n    return this.dx(x).dy(y)\r\n  }\r\n})\r\n\r\nSVG.extend(SVG.Rect, SVG.Ellipse, SVG.Circle, SVG.Gradient, SVG.FX, {\r\n  // Add x and y radius\r\n  radius: function(x, y) {\r\n    var type = (this._target || this).type;\r\n    return type == 'radial' || type == 'circle' ?\r\n      this.attr('r', new SVG.Number(x)) :\r\n      this.rx(x).ry(y == null ? x : y)\r\n  }\r\n})\r\n\r\nSVG.extend(SVG.Path, {\r\n  // Get path length\r\n  length: function() {\r\n    return this.node.getTotalLength()\r\n  }\r\n  // Get point at length\r\n, pointAt: function(length) {\r\n    return this.node.getPointAtLength(length)\r\n  }\r\n})\r\n\r\nSVG.extend(SVG.Parent, SVG.Text, SVG.Tspan, SVG.FX, {\r\n  // Set font\r\n  font: function(a, v) {\r\n    if (typeof a == 'object') {\r\n      for (v in a) this.font(v, a[v])\r\n    }\r\n\r\n    return a == 'leading' ?\r\n        this.leading(v) :\r\n      a == 'anchor' ?\r\n        this.attr('text-anchor', v) :\r\n      a == 'size' || a == 'family' || a == 'weight' || a == 'stretch' || a == 'variant' || a == 'style' ?\r\n        this.attr('font-'+ a, v) :\r\n        this.attr(a, v)\r\n  }\r\n})\r\n\nSVG.Set = SVG.invent({\r\n  // Initialize\r\n  create: function(members) {\r\n    // Set initial state\r\n    Array.isArray(members) ? this.members = members : this.clear()\r\n  }\r\n\r\n  // Add class methods\r\n, extend: {\r\n    // Add element to set\r\n    add: function() {\r\n      var i, il, elements = [].slice.call(arguments)\r\n\r\n      for (i = 0, il = elements.length; i < il; i++)\r\n        this.members.push(elements[i])\r\n\r\n      return this\r\n    }\r\n    // Remove element from set\r\n  , remove: function(element) {\r\n      var i = this.index(element)\r\n\r\n      // remove given child\r\n      if (i > -1)\r\n        this.members.splice(i, 1)\r\n\r\n      return this\r\n    }\r\n    // Iterate over all members\r\n  , each: function(block) {\r\n      for (var i = 0, il = this.members.length; i < il; i++)\r\n        block.apply(this.members[i], [i, this.members])\r\n\r\n      return this\r\n    }\r\n    // Restore to defaults\r\n  , clear: function() {\r\n      // initialize store\r\n      this.members = []\r\n\r\n      return this\r\n    }\r\n    // Get the length of a set\r\n  , length: function() {\r\n      return this.members.length\r\n    }\r\n    // Checks if a given element is present in set\r\n  , has: function(element) {\r\n      return this.index(element) >= 0\r\n    }\r\n    // retuns index of given element in set\r\n  , index: function(element) {\r\n      return this.members.indexOf(element)\r\n    }\r\n    // Get member at given index\r\n  , get: function(i) {\r\n      return this.members[i]\r\n    }\r\n    // Get first member\r\n  , first: function() {\r\n      return this.get(0)\r\n    }\r\n    // Get last member\r\n  , last: function() {\r\n      return this.get(this.members.length - 1)\r\n    }\r\n    // Default value\r\n  , valueOf: function() {\r\n      return this.members\r\n    }\r\n    // Get the bounding box of all members included or empty box if set has no items\r\n  , bbox: function(){\r\n      // return an empty box of there are no members\r\n      if (this.members.length == 0)\r\n        return new SVG.RBox()\r\n\r\n      // get the first rbox and update the target bbox\r\n      var rbox = this.members[0].rbox(this.members[0].doc())\r\n\r\n      this.each(function() {\r\n        // user rbox for correct position and visual representation\r\n        rbox = rbox.merge(this.rbox(this.doc()))\r\n      })\r\n\r\n      return rbox\r\n    }\r\n  }\r\n\r\n  // Add parent method\r\n, construct: {\r\n    // Create a new set\r\n    set: function(members) {\r\n      return new SVG.Set(members)\r\n    }\r\n  }\r\n})\r\n\r\nSVG.FX.Set = SVG.invent({\r\n  // Initialize node\r\n  create: function(set) {\r\n    // store reference to set\r\n    this.set = set\r\n  }\r\n\r\n})\r\n\r\n// Alias methods\r\nSVG.Set.inherit = function() {\r\n  var m\r\n    , methods = []\r\n\r\n  // gather shape methods\r\n  for(var m in SVG.Shape.prototype)\r\n    if (typeof SVG.Shape.prototype[m] == 'function' && typeof SVG.Set.prototype[m] != 'function')\r\n      methods.push(m)\r\n\r\n  // apply shape aliasses\r\n  methods.forEach(function(method) {\r\n    SVG.Set.prototype[method] = function() {\r\n      for (var i = 0, il = this.members.length; i < il; i++)\r\n        if (this.members[i] && typeof this.members[i][method] == 'function')\r\n          this.members[i][method].apply(this.members[i], arguments)\r\n\r\n      return method == 'animate' ? (this.fx || (this.fx = new SVG.FX.Set(this))) : this\r\n    }\r\n  })\r\n\r\n  // clear methods for the next round\r\n  methods = []\r\n\r\n  // gather fx methods\r\n  for(var m in SVG.FX.prototype)\r\n    if (typeof SVG.FX.prototype[m] == 'function' && typeof SVG.FX.Set.prototype[m] != 'function')\r\n      methods.push(m)\r\n\r\n  // apply fx aliasses\r\n  methods.forEach(function(method) {\r\n    SVG.FX.Set.prototype[method] = function() {\r\n      for (var i = 0, il = this.set.members.length; i < il; i++)\r\n        this.set.members[i].fx[method].apply(this.set.members[i].fx, arguments)\r\n\r\n      return this\r\n    }\r\n  })\r\n}\r\n\r\n\r\n\n\r\nSVG.extend(SVG.Element, {\r\n  // Store data values on svg nodes\r\n  data: function(a, v, r) {\r\n    if (typeof a == 'object') {\r\n      for (v in a)\r\n        this.data(v, a[v])\r\n\r\n    } else if (arguments.length < 2) {\r\n      try {\r\n        return JSON.parse(this.attr('data-' + a))\r\n      } catch(e) {\r\n        return this.attr('data-' + a)\r\n      }\r\n\r\n    } else {\r\n      this.attr(\r\n        'data-' + a\r\n      , v === null ?\r\n          null :\r\n        r === true || typeof v === 'string' || typeof v === 'number' ?\r\n          v :\r\n          JSON.stringify(v)\r\n      )\r\n    }\r\n\r\n    return this\r\n  }\r\n})\nSVG.extend(SVG.Element, {\r\n  // Remember arbitrary data\r\n  remember: function(k, v) {\r\n    // remember every item in an object individually\r\n    if (typeof arguments[0] == 'object')\r\n      for (var v in k)\r\n        this.remember(v, k[v])\r\n\r\n    // retrieve memory\r\n    else if (arguments.length == 1)\r\n      return this.memory()[k]\r\n\r\n    // store memory\r\n    else\r\n      this.memory()[k] = v\r\n\r\n    return this\r\n  }\r\n\r\n  // Erase a given memory\r\n, forget: function() {\r\n    if (arguments.length == 0)\r\n      this._memory = {}\r\n    else\r\n      for (var i = arguments.length - 1; i >= 0; i--)\r\n        delete this.memory()[arguments[i]]\r\n\r\n    return this\r\n  }\r\n\r\n  // Initialize or return local memory object\r\n, memory: function() {\r\n    return this._memory || (this._memory = {})\r\n  }\r\n\r\n})\n// Method for getting an element by id\r\nSVG.get = function(id) {\r\n  var node = document.getElementById(idFromReference(id) || id)\r\n  return SVG.adopt(node)\r\n}\r\n\r\n// Select elements by query string\r\nSVG.select = function(query, parent) {\r\n  return new SVG.Set(\r\n    SVG.utils.map((parent || document).querySelectorAll(query), function(node) {\r\n      return SVG.adopt(node)\r\n    })\r\n  )\r\n}\r\n\r\nSVG.extend(SVG.Parent, {\r\n  // Scoped select method\r\n  select: function(query) {\r\n    return SVG.select(query, this.node)\r\n  }\r\n\r\n})\nfunction pathRegReplace(a, b, c, d) {\r\n  return c + d.replace(SVG.regex.dots, ' .')\r\n}\r\n\r\n// creates deep clone of array\r\nfunction array_clone(arr){\r\n  var clone = arr.slice(0)\r\n  for(var i = clone.length; i--;){\r\n    if(Array.isArray(clone[i])){\r\n      clone[i] = array_clone(clone[i])\r\n    }\r\n  }\r\n  return clone\r\n}\r\n\r\n// tests if a given element is instance of an object\r\nfunction is(el, obj){\r\n  return el instanceof obj\r\n}\r\n\r\n// tests if a given selector matches an element\r\nfunction matches(el, selector) {\r\n  return (el.matches || el.matchesSelector || el.msMatchesSelector || el.mozMatchesSelector || el.webkitMatchesSelector || el.oMatchesSelector).call(el, selector);\r\n}\r\n\r\n// Convert dash-separated-string to camelCase\r\nfunction camelCase(s) {\r\n  return s.toLowerCase().replace(/-(.)/g, function(m, g) {\r\n    return g.toUpperCase()\r\n  })\r\n}\r\n\r\n// Capitalize first letter of a string\r\nfunction capitalize(s) {\r\n  return s.charAt(0).toUpperCase() + s.slice(1)\r\n}\r\n\r\n// Ensure to six-based hex\r\nfunction fullHex(hex) {\r\n  return hex.length == 4 ?\r\n    [ '#',\r\n      hex.substring(1, 2), hex.substring(1, 2)\r\n    , hex.substring(2, 3), hex.substring(2, 3)\r\n    , hex.substring(3, 4), hex.substring(3, 4)\r\n    ].join('') : hex\r\n}\r\n\r\n// Component to hex value\r\nfunction compToHex(comp) {\r\n  var hex = comp.toString(16)\r\n  return hex.length == 1 ? '0' + hex : hex\r\n}\r\n\r\n// Calculate proportional width and height values when necessary\r\nfunction proportionalSize(element, width, height) {\r\n  if (width == null || height == null) {\r\n    var box = element.bbox()\r\n\r\n    if (width == null)\r\n      width = box.width / box.height * height\r\n    else if (height == null)\r\n      height = box.height / box.width * width\r\n  }\r\n\r\n  return {\r\n    width:  width\r\n  , height: height\r\n  }\r\n}\r\n\r\n// Delta transform point\r\nfunction deltaTransformPoint(matrix, x, y) {\r\n  return {\r\n    x: x * matrix.a + y * matrix.c + 0\r\n  , y: x * matrix.b + y * matrix.d + 0\r\n  }\r\n}\r\n\r\n// Map matrix array to object\r\nfunction arrayToMatrix(a) {\r\n  return { a: a[0], b: a[1], c: a[2], d: a[3], e: a[4], f: a[5] }\r\n}\r\n\r\n// Parse matrix if required\r\nfunction parseMatrix(matrix) {\r\n  if (!(matrix instanceof SVG.Matrix))\r\n    matrix = new SVG.Matrix(matrix)\r\n\r\n  return matrix\r\n}\r\n\r\n// Add centre point to transform object\r\nfunction ensureCentre(o, target) {\r\n  o.cx = o.cx == null ? target.bbox().cx : o.cx\r\n  o.cy = o.cy == null ? target.bbox().cy : o.cy\r\n}\r\n\r\n// PathArray Helpers\r\nfunction arrayToString(a) {\r\n  for (var i = 0, il = a.length, s = ''; i < il; i++) {\r\n    s += a[i][0]\r\n\r\n    if (a[i][1] != null) {\r\n      s += a[i][1]\r\n\r\n      if (a[i][2] != null) {\r\n        s += ' '\r\n        s += a[i][2]\r\n\r\n        if (a[i][3] != null) {\r\n          s += ' '\r\n          s += a[i][3]\r\n          s += ' '\r\n          s += a[i][4]\r\n\r\n          if (a[i][5] != null) {\r\n            s += ' '\r\n            s += a[i][5]\r\n            s += ' '\r\n            s += a[i][6]\r\n\r\n            if (a[i][7] != null) {\r\n              s += ' '\r\n              s += a[i][7]\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  return s + ' '\r\n}\r\n\r\n// Deep new id assignment\r\nfunction assignNewId(node) {\r\n  // do the same for SVG child nodes as well\r\n  for (var i = node.childNodes.length - 1; i >= 0; i--)\r\n    if (node.childNodes[i] instanceof window.SVGElement)\r\n      assignNewId(node.childNodes[i])\r\n\r\n  return SVG.adopt(node).id(SVG.eid(node.nodeName))\r\n}\r\n\r\n// Add more bounding box properties\r\nfunction fullBox(b) {\r\n  if (b.x == null) {\r\n    b.x      = 0\r\n    b.y      = 0\r\n    b.width  = 0\r\n    b.height = 0\r\n  }\r\n\r\n  b.w  = b.width\r\n  b.h  = b.height\r\n  b.x2 = b.x + b.width\r\n  b.y2 = b.y + b.height\r\n  b.cx = b.x + b.width / 2\r\n  b.cy = b.y + b.height / 2\r\n\r\n  return b\r\n}\r\n\r\n// Get id from reference string\r\nfunction idFromReference(url) {\r\n  var m = url.toString().match(SVG.regex.reference)\r\n\r\n  if (m) return m[1]\r\n}\r\n\r\n// Create matrix array for looping\r\nvar abcdef = 'abcdef'.split('')\n// Add CustomEvent to IE9 and IE10\r\nif (typeof window.CustomEvent !== 'function') {\r\n  // Code from: https://developer.mozilla.org/en-US/docs/Web/API/CustomEvent\r\n  var CustomEvent = function(event, options) {\r\n    options = options || { bubbles: false, cancelable: false, detail: undefined }\r\n    var e = document.createEvent('CustomEvent')\r\n    e.initCustomEvent(event, options.bubbles, options.cancelable, options.detail)\r\n    return e\r\n  }\r\n\r\n  CustomEvent.prototype = window.Event.prototype\r\n\r\n  window.CustomEvent = CustomEvent\r\n}\r\n\r\n// requestAnimationFrame / cancelAnimationFrame Polyfill with fallback based on Paul Irish\r\n(function(w) {\r\n  var lastTime = 0\r\n  var vendors = ['moz', 'webkit']\r\n\r\n  for(var x = 0; x < vendors.length && !window.requestAnimationFrame; ++x) {\r\n    w.requestAnimationFrame = w[vendors[x] + 'RequestAnimationFrame']\r\n    w.cancelAnimationFrame  = w[vendors[x] + 'CancelAnimationFrame'] ||\r\n                              w[vendors[x] + 'CancelRequestAnimationFrame']\r\n  }\r\n\r\n  w.requestAnimationFrame = w.requestAnimationFrame ||\r\n    function(callback) {\r\n      var currTime = new Date().getTime()\r\n      var timeToCall = Math.max(0, 16 - (currTime - lastTime))\r\n\r\n      var id = w.setTimeout(function() {\r\n        callback(currTime + timeToCall)\r\n      }, timeToCall)\r\n\r\n      lastTime = currTime + timeToCall\r\n      return id\r\n    }\r\n\r\n  w.cancelAnimationFrame = w.cancelAnimationFrame || w.clearTimeout;\r\n\r\n}(window))\r\n\r\nreturn SVG\r\n\r\n}));\r\n\n\n// WEBPACK FOOTER //\n// ./node_modules/svg.js/dist/svg.js"],"sourceRoot":""}